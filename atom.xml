<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>èŠ±ç”Ÿè±†æ‹é»„ç“œ</title>
  
  <subtitle>è¡Œæ˜¯çŸ¥ä¹‹å§‹ï¼ŒçŸ¥æ˜¯è¡Œä¹‹æˆ</subtitle>
  <link href="http://blog.soul11201.com/atom.xml" rel="self"/>
  
  <link href="http://blog.soul11201.com/"/>
  <updated>2024-07-02T14:59:25.834Z</updated>
  <id>http://blog.soul11201.com/</id>
  
  <author>
    <name>soul11201</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Golang - Nä¸ªåç¨‹äº¤æ›¿æ‰“å°æ•°å­—</title>
    <link href="http://blog.soul11201.com/2024/07/02/goroutin-print-number/"/>
    <id>http://blog.soul11201.com/2024/07/02/goroutin-print-number/</id>
    <published>2024-07-02T12:39:36.000Z</published>
    <updated>2024-07-02T14:59:25.834Z</updated>
    
    <content type="html"><![CDATA[<div class="note note-info">            <p>Nä¸ªåç¨‹äº¤æ›¿æ‰“å°æ•°å­—ï¼Œåˆ°è¾¾ä¸€ä¸ªæ•°å€¼åç»ˆæ­¢</p>          </div><h2 id="ç½‘å‹è§£æ³•">ç½‘å‹è§£æ³•</h2><p>ç½‘ä¸Šæœç´¢çš„è§£æ³•å¤§æ¦‚å¦‚ä¸‹ï¼Œç½‘å‹é”™åˆ«å­—åœ°æ–¹å·²ç»ä¿®å¤</p><blockquote><p>å¯åŠ¨Nä¸ªåç¨‹ï¼Œå…±ç”¨ä¸€ä¸ªå¤–éƒ¨å˜é‡è®¡æ•°å™¨ï¼Œè®¡æ•°å™¨èŒƒå›´æ˜¯1åˆ°100</p><p>å¼€å¯Nä¸ª<code>æ— </code>ç¼“å†²chanï¼Œchans[i]å¡å…¥æ•°æ®ä»£è¡¨åç¨‹iå¯ä»¥è¿›è¡Œæ‰“å°äº†ï¼Œæ‰“å°çš„æ•°å­—å°±æ˜¯è®¡æ•°å™¨çš„æ•°</p><p>åç¨‹iä¸€ç›´é˜»å¡ï¼Œç›´åˆ°chan[i]é€šé“æœ‰æ•°æ®å¯ä»¥æ‹‰ï¼Œæ‰æ‰“å°</p></blockquote><h2 id="åˆ†æ">åˆ†æ</h2><p>å¤§æ€è·¯æ²¡æœ‰é—®é¢˜ï¼Œä½†<ahref="https://gist.github.com/noname007/6fd0a23920fa115618dbef2504511727?permalink_comment_id=5108543#gistcomment-5108543">å…·ä½“å®ç°</a>çš„å°ç»†èŠ‚å¤„ç†ä¸Šå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ã€‚</p><ul><li>N ä¸º 1 çš„æ—¶å€™å­˜åœ¨æ­»é”é—®é¢˜</li><li>ç¨‹åºè¿è¡Œå®Œåï¼Œåç¨‹æ²¡æœ‰å›æ”¶ï¼Œè¿™ä¸ªæ¯”è¾ƒä¸¥é‡ã€‚<ul><li>é¦–å…ˆï¼Œç ´åäº†<code>è°ç”³è¯·ã€è°é‡Šæ”¾</code>èµ„æºç®¡ç†çš„åŸºæœ¬è®¾è®¡åŸåˆ™</li><li>å…¶æ¬¡ï¼Œå¸¸é©»å†…å­˜è¿è¡Œæ—¶å¦‚æœç»å¸¸è¢«å…¶ä»–åç¨‹è°ƒç”¨ï¼Œåº”ç”¨æœ‰ OOM çš„é£é™©ã€‚</li></ul></li></ul><p>åªèƒ½ä½œä¸ºä¸€æ¬¡æ€§è„šæœ¬è°ƒç”¨ï¼Œè¿è¡Œç»“æŸåæ•´ä¸ªè¿›ç¨‹è¢«æ“ä½œç³»ç»Ÿå›æ”¶ã€‚é’ˆå¯¹ä¸¤ä¸ªé—®é¢˜åšå¦‚ä¸‹ä¿®æ­£:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>    <span class="hljs-string">&quot;fmt&quot;</span><br>    <span class="hljs-string">&quot;sync&quot;</span><br>)<br><br><br><br><span class="hljs-keyword">var</span> counter = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">const</span> CounterMaxValue = <span class="hljs-number">100</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DoJob</span><span class="hljs-params">(GoRoutineNum <span class="hljs-type">int</span>)</span></span> &#123;<br><br>    <span class="hljs-comment">//ç”¨äºæ§åˆ¶ä¸šåŠ¡é€»è¾‘</span><br>    sigChannel := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">chan</span> <span class="hljs-keyword">struct</span>&#123;&#125;, GoRoutineNum)<br>    <span class="hljs-comment">//ç”¨äºæ§åˆ¶åæˆæ˜¯å¦ç»ˆç»“</span><br>    quitSigChannel := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">chan</span> <span class="hljs-keyword">struct</span>&#123;&#125;, GoRoutineNum)<br><br>    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; (GoRoutineNum); i++ &#123;<br>        sigChannel[i] = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">struct</span>&#123;&#125;)<br>        quitSigChannel[i] = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">struct</span>&#123;&#125;)<br>    &#125;<br><br>    mainRoutine := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">struct</span>&#123;&#125;)<br><br>    wg := sync.WaitGroup&#123;&#125;<br><br>    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; GoRoutineNum; i++ &#123;<br>        wg.Add(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(idx <span class="hljs-type">int</span>)</span></span> &#123;<br>            <span class="hljs-keyword">defer</span> wg.Done()<br>            <span class="hljs-comment">//FOR:</span><br>            <span class="hljs-keyword">for</span> &#123;<br>                <span class="hljs-keyword">select</span> &#123;<br>                <span class="hljs-keyword">case</span> &lt;-quitSigChannel[idx]:<br>                    <span class="hljs-comment">//break FOR</span><br>                    <span class="hljs-keyword">goto</span> END<br>                <span class="hljs-keyword">case</span> &lt;-sigChannel[idx]:<br>                    fmt.Printf(<span class="hljs-string">&quot;goroutine-num:%d %d\n&quot;</span>, idx, counter)<br>                    counter += <span class="hljs-number">1</span><br>                    mainRoutine &lt;- <span class="hljs-keyword">struct</span>&#123;&#125;&#123;&#125;<br>                &#125;<br><br>            &#125;<br>        END:<br>            fmt.Printf(<span class="hljs-string">&quot;goroutine-num:%d end\n&quot;</span>, idx)<br>        &#125;(i)<br>    &#125;<br><br>    wg.Add(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>        wg.Done()<br><br>        <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; CounterMaxValue; i++ &#123;<br>            <span class="hljs-comment">//&lt;-mainRoutine</span><br>            sigChannel[i%GoRoutineNum] &lt;- <span class="hljs-keyword">struct</span>&#123;&#125;&#123;&#125;<br>            &lt;-mainRoutine<br>        &#125;<br><br>        <span class="hljs-comment">////ä½¿æœ€åä¸€ä¸ªä»»åŠ¡å¤„ç†åæˆï¼Œè¿›å…¥ä¿¡å·ç­‰å¾…çŠ¶æ€</span><br>        <span class="hljs-comment">//&lt;-mainRoutine</span><br><br>        <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; GoRoutineNum; i++ &#123;<br>            quitSigChannel[i] &lt;- <span class="hljs-keyword">struct</span>&#123;&#125;&#123;&#125;<br>        &#125;<br>    &#125;()<br><br>    <span class="hljs-comment">//mainRoutine &lt;- struct&#123;&#125;&#123;&#125;</span><br>    wg.Wait()<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    DoJob(<span class="hljs-number">10</span>)<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ğŸ¤ ååŒäº¤æ›¿æ‰“å°æ•°å­—</summary>
    
    
    
    <category term="ç³»ç»Ÿç¼–ç¨‹" scheme="http://blog.soul11201.com/categories/%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Golang" scheme="http://blog.soul11201.com/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>volatile å®æˆ˜ - ä½¿ç”¨ä¿¡å·å®ç° sleep å‡½æ•°</title>
    <link href="http://blog.soul11201.com/2024/06/17/volatile/"/>
    <id>http://blog.soul11201.com/2024/06/17/volatile/</id>
    <published>2024-06-17T11:51:26.000Z</published>
    <updated>2024-07-01T08:36:13.959Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æºç ">æºç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;signal.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-type">static</span> <span class="hljs-type">int</span> sleepFlag = <span class="hljs-number">1</span>;<br><br><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">alrm_handler</span><span class="hljs-params">(<span class="hljs-type">int</span> signo)</span>&#123;<br>    sleepFlag = <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">mySleep</span><span class="hljs-params">(<span class="hljs-type">int</span> sec)</span><br>&#123;<br>    signal(SIGALRM,alrm_handler);<br>    alarm(sec);<br>    <br>    <span class="hljs-keyword">while</span>(sleepFlag);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¼€å¯ä¼˜åŒ–é€‰é¡¹åï¼Œç¨‹åºå˜æˆäº†æ­»å¾ªç¯ã€‚ä»ä¸‹é¢çš„æ±‡ç¼–ä»£ç ï¼Œä¸éš¾å‘ç°ç¼–è¯‘å™¨ä¼˜åŒ–äº†sleepFlag çš„è¯»å–ï¼Œå¯¼è‡´äº†æ­»å¾ªç¯ã€‚</p><figure><img src="/assets/2024-06-17-O0.png" title="ä¸å¼€å¯ä¼˜åŒ–"alt="ä¸å¼€å¯ä¼˜åŒ–" /><figcaption aria-hidden="true">ä¸å¼€å¯ä¼˜åŒ–</figcaption></figure><figure><img src="/assets/2024-06-17-O3.png" title="O3 ä¼˜åŒ–" alt="O3 ä¼˜åŒ–" /><figcaption aria-hidden="true">O3 ä¼˜åŒ–</figcaption></figure><h2 id="volatile-ä½¿ç”¨åœºæ™¯æ€»ç»“-1">volatile ä½¿ç”¨åœºæ™¯æ€»ç»“<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="[https://blog.csdn.net/tigerjibo/article/details/7427366](https://blog.csdn.net/tigerjibo/article/details/7427366)">[1]</span></a></sup></h2><h3id="åœ¨ä¸­æ–­æœåŠ¡ç¨‹åºä¸­è¿›è¡Œä¿®æ”¹çš„å…±äº«å˜é‡">åœ¨ä¸­æ–­æœåŠ¡ç¨‹åºä¸­è¿›è¡Œä¿®æ”¹çš„å…±äº«å˜é‡</h3><p>ä¸Šé¢ä¸­ <code>sleepFlag</code> å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚</p><h3 id="å¤šçº¿ç¨‹é—´å…±äº«çš„å˜é‡">å¤šçº¿ç¨‹é—´å…±äº«çš„å˜é‡</h3><h3id="å¯¹ç¡¬ä»¶å¯„å­˜å™¨2è¿›è¡Œæ˜ å°„çš„å˜é‡">å¯¹ç¡¬ä»¶å¯„å­˜å™¨<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="[https://www.runoob.com/w3cnote/c-volatile-keyword.html](https://www.runoob.com/w3cnote/c-volatile-keyword.html)">[2]</span></a></sup>è¿›è¡Œæ˜ å°„çš„å˜é‡</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span>  *output = (<span class="hljs-type">unsigned</span>  <span class="hljs-type">int</span> *)<span class="hljs-number">0xff800000</span>;<span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªIOç«¯å£ï¼›</span><br><span class="hljs-type">int</span>   <span class="hljs-title function_">init</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-type">int</span> i;<br>    <span class="hljs-comment">//ä¼šè¢«ä¼˜åŒ–ä¸º *output = 9</span><br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt; <span class="hljs-number">10</span>;i++)&#123;<br>        *output = i;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><ahref="https://blog.csdn.net/tigerjibo/article/details/7427366">https://blog.csdn.net/tigerjibo/article/details/7427366</a><a href="#fnref:1" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><ahref="https://www.runoob.com/w3cnote/c-volatile-keyword.html">https://www.runoob.com/w3cnote/c-volatile-keyword.html</a><a href="#fnref:2" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><ahref="https://zh.wikipedia.org/wiki/%E7%A1%AC%E9%AB%94%E6%9A%AB%E5%AD%98%E5%99%A8">ç¡¬ä»¶å¯„å­˜å™¨</a><a href="#fnref:3" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">volatile ä¸ ç¼–è¯‘ä¼˜åŒ–</summary>
    
    
    
    <category term="ç³»ç»Ÿç¼–ç¨‹" scheme="http://blog.soul11201.com/categories/%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="C" scheme="http://blog.soul11201.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>Gitlab CI/CD æ”¹é€ å›é¡¾æ€»ç»“ â™»ï¸</title>
    <link href="http://blog.soul11201.com/2024/06/04/xhs-gitlab-ci/"/>
    <id>http://blog.soul11201.com/2024/06/04/xhs-gitlab-ci/</id>
    <published>2024-06-04T07:23:30.000Z</published>
    <updated>2024-07-02T14:32:05.871Z</updated>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2><p>æˆ‘æ˜¯22å¹´å…¥èŒçš„å…¬å¸ã€‚</p><p>åœ¨ç†Ÿæ‚‰ç¯å¢ƒçš„è¿‡ç¨‹ä¸­å‘ç°ï¼šå…¬å¸å¯¹ Goçš„æ”¯æŒäººåŠ›æŠ•å…¥æœ‰é™ï¼Œæ„å»ºè¿‡ç¨‹ç¼ºå°‘è§„èŒƒã€æ²¡æœ‰æŒ‡å¯¼æ–‡æ¡£ã€‚æ¯”æˆ‘å…¥èŒæ—©çš„ä¸€ä½åŒäº‹ï¼Œé è‡ªå·±ä¸œæ‰¾æ‰¾è¥¿æ‰¾æ‰¾ï¼Œç¼åˆäº†ä¸€ä¸ªGitlab çš„ <code>yml</code> æ–‡ä»¶ã€‚</p><p>æˆ‘å½“æ—¶è§‰å¾—è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥‡è‘©çš„äº‹æƒ…ï¼Œå°±æ‹‰ä¸Šä¸­é—´ä»¶å›¢é˜Ÿã€ç ”æ•ˆã€åŸºç¡€è®¾æ–½å›¢é˜Ÿçš„åŒäº‹ç»„äº†ä¸€ä¸ªå…¬å¸çš„Go æŠ€æœ¯äº¤æµç¾¤ã€‚æ²Ÿé€šè¿‡ç¨‹ä¸­å‘ç°ï¼Œæ„å»º Go åŸºç¡€é•œåƒçš„<code>Dockerfile</code> æ–‡ä»¶ä¹Ÿä¸¢å¤±äº†ï¼Œè¿™ä¸‹å¯å¥½ä¸€ä»¶äº‹å˜æˆäº†ä¸¤ä»¶äº‹ã€‚</p><p>é’ˆå¯¹ <code>Gitlab çš„ç¼–æ’æµç¨‹</code>å’Œ<code>GoåŸºç¡€é•œåƒçš„æ„å»º</code>ï¼Œç»“åˆè‡ªå·±çš„é¡¹ç›®å®é™…æƒ…å†µè¿›è¡Œäº†<code>é€ è½®å­</code>ã€‚å»å¹´9æœˆï¼Œç ”æ•ˆå›¢é˜ŸæŠŠ<code>Go åŸºç¡€é•œåƒçš„æ„å»º</code>çš„ä¹Ÿæ¥è¿‡æ‰‹å»äº†ï¼Œå¯¹è¿™ä»¶äº‹ç®—æ˜¯ç”»ä¸Šäº†ä¸€ä¸ªç›¸å¯¹å®Œæ»¡çš„å¥å·ã€‚ä¸‹é¢å¯¹é€ è½®å­çš„è¿‡ç¨‹è¿›è¡Œä¸€ä¸ªç®€è¦çš„å›é¡¾æ€»ç»“ã€‚</p><h2 id="ç ”å‘æµç¨‹">ç ”å‘æµç¨‹</h2><p>å…ˆç®€å•çš„è¯´ä¸‹ CI æµç¨‹</p><figure><img src="/assets/2024-06-04-xhs-ci-cd-flow.png"title="ä»£ç é›†æˆã€æ„å»ºã€å‘ç‰ˆæµç¨‹" alt="é›†æˆã€å‘ç‰ˆæµç¨‹" /><figcaption aria-hidden="true">é›†æˆã€å‘ç‰ˆæµç¨‹</figcaption></figure><ol type="1"><li>å¼€å‘äººå‘˜æäº¤ä»£ç åˆ° Gitlab</li><li>Gitlab CI/CD è‡ªåŠ¨æ„å»º</li><li>æ„å»ºæˆåŠŸåï¼Œé•œåƒæ¨é€åˆ° Harbor</li><li>ç ”å‘äººå‘˜å»å‘ç‰ˆç³»ç»Ÿé€‰æ‹©æ„å»ºå¥½çš„é•œåƒè¿›è¡Œå‘å¸ƒåˆ°æµ‹è¯•ã€æ­£å¼ç¯å¢ƒ</li></ol><h2 id="æ”¹é€ ">æ”¹é€ </h2><p><img src="/imgs/2024-06-04-gitlab-ci-workflow.drawio.png"title="Gitlab CI/CD å·¥ä½œæµç¨‹" /></p><h3 id="æ”¹é€ -golang-åŸºç¡€é•œåƒ">æ”¹é€  Golang åŸºç¡€é•œåƒ</h3><h4 id="åè§£æ—§é•œåƒdockerfile">åè§£æ—§é•œåƒ<code>Dockerfile</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -v /var/run/docker.sock:/var/run/docker.sock --rm alpine/dfimage $&#123;PRIVATE_DOCKER_REPO&#125;/base/xhs-golang:1.15 <br></code></pre></td></tr></table></figure><p>ä»è¾“å‡ºç»“æœæ¥çœ‹ä¸»è¦éœ€è¦åšäº†å¦‚ä¸‹å‡ ä»¶äº‹æƒ… 1. åŸºç¡€é•œåƒä½¿ç”¨<code>debian:buster-20200803</code> 2. copy go 1.15 çš„åŒ…åˆ°é•œåƒå†… 3. æ›´æ”¹apt é•œåƒæº 4. ä¿®æ”¹æ—¶åŒºã€è¯­è¨€è®¾ç½®ã€ç¯å¢ƒå˜é‡ 5.å®‰è£…ä¸€äº›ä¾èµ–ä½¿ç”¨çš„è½¯ä»¶åŒ…</p><h4 id="é‡æ–°å°è£…-golang-åŸºç¡€é•œåƒ-dockerfile">é‡æ–°å°è£… Golang åŸºç¡€é•œåƒDockerfile</h4><p>åŸºäºåè§£åçš„ä¿¡æ¯ï¼Œå’ŒåŒäº‹å…ˆå‰åšçš„ CI è„šæœ¬é‡æ–°å°è£…äº†ä¸€ä¸ª Golangçš„åŸºç¡€é•œåƒã€‚</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Dockerfile"><span class="hljs-keyword">FROM</span> golang:<span class="hljs-number">1.18</span>-bullseye<br><br><span class="hljs-keyword">RUN</span><span class="language-bash">  <span class="hljs-built_in">cat</span> /etc/apt/sources.list &amp;&amp; \</span><br><span class="language-bash">     sed -i <span class="hljs-string">&quot;s/deb.debian.org/mirrors.tuna.tsinghua.edu.cn/g&quot;</span> /etc/apt/sources.list &amp;&amp; \</span><br><span class="language-bash">     sed -i <span class="hljs-string">&quot;s/security.debian.org/mirrors.tuna.tsinghua.edu.cn/g&quot;</span> /etc/apt/sources.list &amp;&amp; \</span><br><span class="language-bash">     <span class="hljs-built_in">cat</span> /etc/apt/sources.list &amp;&amp; \</span><br><span class="language-bash">     apt update &amp;&amp;  \</span><br><span class="language-bash">     apt install upx -y &amp;&amp; \</span><br><span class="language-bash">     <span class="hljs-built_in">rm</span> -rf /var/lib/apt/lists/*</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">cp</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime  \</span><br><span class="language-bash">         &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span> &gt; /etc/timezone  \</span><br><span class="language-bash">         &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;alias ll=&#x27;ls -l --color&#x27;&quot;</span> &gt;&gt; /root/.bashrc</span><br><br><span class="hljs-keyword">ENV</span>  GO111MODULE=on GOPROXY=https://goproxy.cn GOPRIVATE=code.devops.xiaohongshu.com<br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> git config --global url.<span class="hljs-string">&quot;git@code.devops.xiaohongshu.com:&quot;</span>.insteadof <span class="hljs-string">&quot;https://code.devops.xiaohongshu.com/&quot;</span> &amp;&amp; \</span><br><span class="language-bash">    git config --global --add url.<span class="hljs-string">&quot;git@code.devops.xiaohongshu.com:&quot;</span>.insteadof <span class="hljs-string">&quot;http://code.devops.xiaohongshu.com/&quot;</span></span><br><br><span class="hljs-keyword">COPY</span><span class="language-bash"> id_rsa /root/.ssh/</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> id_rsa.pub /root/.ssh/</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash">  ssh-keyscan code.devops.xiaohongshu.com &gt; /root/.ssh/known_hosts &amp;&amp; \</span><br><span class="language-bash">      <span class="hljs-built_in">chmod</span> 600 ~/.ssh/id_rsa</span><br></code></pre></td></tr></table></figure><ol type="1"><li>åŸºäº Go å®˜æ–¹æä¾›çš„æœ€æ–°é•œåƒ<code>golang:1.18-bullseye</code>è¿›è¡Œæ„å»º</li><li>ä¿®æ”¹é•œåƒæºã€å®‰è£…éœ€è¦çš„ç”¨åˆ°çš„è½¯ä»¶åŒ…ã€æ¸…ç† apt åŒ…ç¼“å­˜ã€æ›´æ”¹æ—¶åŒº</li><li>é…ç½® Go ç§æœ‰ä»“åº“ã€å…±æœ‰ä»“åº“ä»£ç†ã€‚</li><li>é…ç½®å¯†é’¥ï¼Œé˜²æ­¢ gitlabæœ‰äº›ä»“åº“å› ä¸ºæƒé™é—®é¢˜æ— æ³•æ‹‰å–ã€‚å¯†é’¥å¯ä»¥ä¸é…ç½®ï¼Œæ”¾åœ¨ä¸»æœºçš„æŸä¸ªæ–‡ä»¶è·¯å¾„ä¸‹é¢ï¼Œä½¿ç”¨å·æŒ‚è½½çš„æ–¹å¼ä½¿è¿›è¡Œå…±äº«ã€‚</li></ol><h3 id="æ”¹é€ -golang-åº”ç”¨ç¨‹åºè¿è¡Œæ—¶é•œåƒ">æ”¹é€  Golangåº”ç”¨ç¨‹åºè¿è¡Œæ—¶é•œåƒ</h3><h4 id="åè§£æ—§é•œåƒdockerfile-1">åè§£æ—§é•œåƒ<code>Dockerfile</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -v /var/run/docker.sock:/var/run/docker.sock alpine/dfimage  $&#123;PRIVATE_DOCKER_REPO&#125;/base/xhs-debian:10<br></code></pre></td></tr></table></figure><p>åŸºç¡€é•œåƒçš„æ„å»ºè¿‡ç¨‹ä¸»è¦åšäº†å‡ ä»¶äº‹ï¼š 1. é€‰å®šåŸºç¡€é•œåƒï¼š <ahref="https://dso.docker.com/images/debian/digests/sha256:a44ab0cca6cd9411032d180bc396f19bc98f71972d2398d50460145cab81c5ab">debian:buster-20200803</a>ï¼ˆxhs-debianæ„å»ºæ—¶çš„Debian latest ç‰ˆæœ¬ï¼‰ 2. æœ¬åœ°åŒ–è®¾ç½®ï¼šæ›´æ”¹æ—¶åŒºã€è®¾ç½®è¯­è¨€å­—ç¬¦é›†ã€æ›´æ”¹é•œåƒæº3. å®‰è£…äº†ä¸€äº›éæ‰€æœ‰åœºæ™¯éƒ½éœ€è¦çš„è½¯ä»¶</p><h4 id="é‡æ–°å°è£…-golang-åº”ç”¨ç¨‹åºè¿è¡Œæ—¶é•œåƒ-dockerfile">é‡æ–°å°è£… Golangåº”ç”¨ç¨‹åºè¿è¡Œæ—¶é•œåƒ Dockerfile</h4><p>åŸç†å¼„æ¸…æ¥šï¼Œé—®é¢˜å°±å¾ˆå®¹æ˜“è§£å†³ã€‚ä¸‹é¢å¯¹åº”ç”¨ç¨‹åºçš„åŸºç¡€é•œåƒæ¯ä¸€æ­¥åšå¦‚ä¸‹çš„ä¼˜åŒ–å‡çº§ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Dockerfile"><span class="hljs-keyword">FROM</span> debian:stable-slim<br><br><span class="hljs-keyword">RUN</span><span class="language-bash">  <span class="hljs-built_in">cat</span> /etc/apt/sources.list &amp;&amp; \</span><br><span class="language-bash">     sed -i <span class="hljs-string">&quot;s/deb.debian.org/mirrors.tuna.tsinghua.edu.cn/g&quot;</span> /etc/apt/sources.list &amp;&amp; \</span><br><span class="language-bash">     sed -i <span class="hljs-string">&quot;s/security.debian.org/mirrors.tuna.tsinghua.edu.cn/g&quot;</span> /etc/apt/sources.list &amp;&amp; \</span><br><span class="language-bash">     <span class="hljs-built_in">cat</span> /etc/apt/sources.list</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">cp</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime  \</span><br><span class="language-bash">         &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span> &gt; /etc/timezone  \</span><br><span class="language-bash">         &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;alias ll=&#x27;ls -l --color&#x27;&quot;</span> &gt;&gt; /root/.bashrc</span><br><span class="hljs-keyword">ENV</span> LANG=C.UTF-<span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><ol type="1"><li>æ¢ä¸€ä¸ªæ¯”è¾ƒç²¾å·§çš„OS ï¼Œæœ€åé€‰äº† Debian Slim (â†˜ï¸<ahref="https://groups.google.com/g/golang-nuts/c/15TLaxqUpA0">alpine vsslim</a>)<ol type="1"><li>é•œåƒç›¸å¯¹æ¥è¯´ä¹Ÿæ¯”è¾ƒå°ï¼šåˆ é™¤äº†å¾ˆå¤šè¿è¡Œæ—¶ç”¨ä¸åˆ°çš„ä¸œè¥¿</li><li>glibc vs musl<ol type="1"><li>â†˜ï¸<ahref="https://wiki.musl-libc.org/functional-differences-from-glibc.html">Functionaldifferences from glibc</a></li><li>musl è·‘çº¯ Go çš„é¡¹ç›®ä¸€èˆ¬é—®é¢˜ä¸å¤§ï¼Œä½†æ˜¯ç¢°åˆ°éœ€è¦ä½¿ç”¨ä¾èµ– glibcçš„é¡¹ç›®å°±å¾ˆéº»çƒ¦</li></ol></li><li>åŒ…ç®¡ç†å™¨ï¼Œçº¿ä¸Šå‡ºç°é—®é¢˜æ—¶ï¼Œè¿˜èƒ½ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£… Deb åŒ… æ’æŸ¥é—®é¢˜</li><li>è¿è¡Œæ—¶ç”¨ä¸åˆ°çš„è½¯ä»¶å°±ä¸è£…äº†ï¼Œé™¤äº†æµªè´¹ç©ºé—´ã€å¢åŠ æ”»å‡»é¢æš‚æ—¶ä¹Ÿæ²¡å‘ç°å…¶ä»–ç”¨å¤„~</li></ol></li><li>é•œåƒæºã€è¯­è¨€ã€æ—¶åŒºï¼Œç…§æŠ„åŸæ¥é•œåƒçš„è®¾ç½®</li></ol><h4 id="æ•ˆæœ">æ•ˆæœ</h4><ol type="1"><li>é•œåƒå¤§å°ä» 440M â†’ 110M ï¼ˆalpine èƒ½é™åˆ° 36M ï¼‰</li><li>285ä¸ªä¸­ã€é«˜ã€è‡´å‘½æ¼æ´ é™ä½ä¸º 23 ä¸ªä½çº§é£é™©é—®é¢˜</li></ol><p><img src="/imgs/2024-06-04-old-golang-runtime-docker-image.png"title="æ—§è¿è¡Œæ—¶é•œåƒ" /></p><p><img src="/imgs/2024-06-04-new-golang-runtime-container-image.png"title="æ–°è¿è¡Œæ—¶é•œåƒ" /></p><h3 id="æ”¹é€ -.gitlab-ci.yml">æ”¹é€  <code>.gitlab-ci.yml</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">set</span> -x<br><span class="hljs-comment"># åŸºäº Dockerfile æ„å»ºé•œåƒï¼Œå¹¶å°†æ„å»ºåçš„é•œåƒæ¨é€åˆ°ç§æœ‰é•œåƒä»“åº“</span><br><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">docker_build</span></span>() &#123;<br>    <span class="hljs-built_in">local</span> app_id=<span class="hljs-variable">$1</span><br>    <span class="hljs-built_in">local</span> docker_tags=<span class="hljs-variable">$2</span><br>    docker build .  -t <span class="hljs-variable">$&#123;PRIVATE_DOCKER_REPO&#125;</span>/qa/<span class="hljs-string">&quot;<span class="hljs-variable">$app_id</span>&quot;</span>:<span class="hljs-string">&quot;<span class="hljs-variable">$docker_tags</span>&quot;</span><br>    docker login -u username -p passwordk <span class="hljs-variable">$&#123;PRIVATE_DOCKER_REPO&#125;</span><br>    docker push <span class="hljs-variable">$&#123;PRIVATE_DOCKER_REPO&#125;</span>/qa/<span class="hljs-string">&quot;<span class="hljs-variable">$app_id</span>&quot;</span>:<span class="hljs-string">&quot;<span class="hljs-variable">$docker_tags</span>&quot;</span><br>&#125;<br><br><br><br><span class="hljs-comment"># æ›´æ”¹æ—¶åŒºï¼Œä¸ç„¶ date å‡½æ•°æ—¶é—´ä¼šè®¡ç®—é”™è¯¯</span><br>sed -i <span class="hljs-string">&#x27;s/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g&#x27;</span> /etc/apk/repositories<br>apk add -U tzdata<br><span class="hljs-built_in">cp</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<br>CURRENT_DATETIME=<span class="hljs-string">&quot;<span class="hljs-subst">$(date +%Y%m%d_%H%M)</span>&quot;</span><br><br><br>tags=<span class="hljs-variable">$1</span><br>bin=<span class="hljs-variable">$2</span><br><span class="hljs-built_in">cp</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;bin&#125;</span>&quot;</span> ./app<br>docker_build <span class="hljs-variable">$&#123;APP_ID&#125;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;tags&#125;</span>_<span class="hljs-variable">$&#123;CURRENT_DATETIME&#125;</span>&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment"># æ­¤é•œåƒç”¨äºæ‰§è¡Œ docker è¿è¡Œæ—¶é•œåƒçš„æ„å»º</span><br><span class="hljs-attr">image:</span> <span class="hljs-string">$&#123;PRIVATE_DOCKER_REPO&#125;/library/docker:v1.0</span><br><br><span class="hljs-comment"># gitlab å…³é”®å­—ï¼Œåˆ†å‡ ä¸ªé˜¶æ®µ</span><br><span class="hljs-attr">stages:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">compile</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">publish</span><br><br><span class="hljs-comment"># ä»£ç ç¼–è¯‘é˜¶æ®µ</span><br><span class="hljs-attr">compile:</span><br>  <span class="hljs-attr">stage:</span> <span class="hljs-string">compile</span><br>  <span class="hljs-attr">image:</span> <span class="hljs-string">$&#123;PRIVATE_DOCKER_REPO&#125;/qa/itworkspace:go_1.21_latest</span><br><br>  <span class="hljs-attr">before_script:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">go</span> <span class="hljs-string">version</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">ls</span> <span class="hljs-string">-alh</span><br>  <span class="hljs-attr">script:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">go</span> <span class="hljs-string">mod</span> <span class="hljs-string">tidy</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">go</span> <span class="hljs-string">build</span> <span class="hljs-string">-o</span> <span class="hljs-string">./app_dir/http</span> <span class="hljs-string">./cmd/http.go</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">upx</span> <span class="hljs-string">./app_dir/http</span><br>  <br>  <span class="hljs-comment"># ç¼–è¯‘æˆåŠŸåï¼Œå°†äº§ç‰©å…±äº«ç»™ä¸‹ä¸€ä¸ªé˜¶æ®µ</span><br>  <span class="hljs-attr">artifacts:</span><br>    <span class="hljs-attr">paths:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;./app_dir&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;./conf&quot;</span><br>    <span class="hljs-attr">untracked:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-comment"># ç¼–è¯‘æˆåŠŸåï¼Œæ‰è¿›è¡Œäº§ç‰©ç¼“å­˜</span><br>    <span class="hljs-attr">when:</span> <span class="hljs-string">on_success</span><br><br><span class="hljs-comment"># é•œåƒæ„å»ºé˜¶æ®µ</span><br><span class="hljs-attr">publish_http:</span><br>  <span class="hljs-attr">stage:</span> <span class="hljs-string">publish</span><br>  <span class="hljs-attr">script:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">cp</span> <span class="hljs-string">./conf/app.sit.yaml</span> <span class="hljs-string">./conf/app.yaml</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">/bin/sh</span> <span class="hljs-string">./build.gitlab.sh</span> <span class="hljs-string">sit_http</span> <span class="hljs-string">./app_dir/http</span><br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2><ol type="1"><li><div class="douban-card-block">    <a class="douban-card" href="https://book.douban.com/subject/26285268">        <div bg-lazy class="douban-card-bgimg" style="background-image: url('https://images.weserv.nl/?url=https://img1.doubanio.com/view/subject/s/public/s27967469.jpg');">        </div>        <div class="douban-card-left">            <div bg-lazy class="douban-card-img" style="background-image: url('https://images.weserv.nl/?url=https://img1.doubanio.com/view/subject/s/public/s27967469.jpg');">            </div>            <div class="douban-card-status">è§å­—å¦‚æ™¤</div>        </div>        <div class="douban-card-right" style="line-height: 1.7;">            <div class="douban-card-item"><span>ä¹¦å: </span><strong>ç¬¬ä¸€æœ¬Dockerä¹¦</strong></div>            <div class="douban-card-item"><span>ä½œè€…: </span><span>[æ¾³]è©¹å§†æ–¯â€¢ç‰¹æ©å¸ƒå°”ï¼ˆJamesTurnbullï¼‰</span></div>            <div class="douban-card-item"><span>å‡ºç‰ˆå¹´ä»½: </span><span>2014-12</span></div>            <div class="douban-card-item"><span>è¯„åˆ†: </span><span>7.3</span></div>        </div>    </a></div></li></ol>]]></content>
    
    
    <summary type="html">ğŸ’ª æ”¹é€ å…¬å¸åŸºç¡€è®¾æ–½</summary>
    
    
    
    <category term="ç ”å‘æ•ˆèƒ½" scheme="http://blog.soul11201.com/categories/%E7%A0%94%E5%8F%91%E6%95%88%E8%83%BD/"/>
    
    
    <category term="Docker" scheme="http://blog.soul11201.com/tags/Docker/"/>
    
    <category term="Golang" scheme="http://blog.soul11201.com/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨å‘½ä»¤è¡Œæ‰¹é‡åˆ é™¤ Github ä»“åº“</title>
    <link href="http://blog.soul11201.com/2024/05/28/delete-github-repo-use-gh-xargs/"/>
    <id>http://blog.soul11201.com/2024/05/28/delete-github-repo-use-gh-xargs/</id>
    <published>2024-05-28T09:46:58.000Z</published>
    <updated>2024-07-01T08:37:42.346Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å®‰è£…-gh">å®‰è£… gh</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">gh auth login<br>gh auth refresh -h github.com -s delete_repo<br></code></pre></td></tr></table></figure><h2 id="æ‰¹é‡åˆ é™¤ä»“åº“">æ‰¹é‡åˆ é™¤ä»“åº“</h2><p>å¾…åˆ é™¤çš„ä»“åº“æ‰¹é‡æ”¾å…¥ <code>github.repo.txt</code>æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œæ¯è¡Œä¸€ä¸ªä»“åº“åã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> github.repo.txt | xargs -I &#123;&#125;  -n 1  gh repo delete &#123;&#125; --<span class="hljs-built_in">yes</span><br></code></pre></td></tr></table></figure><figure><img src="/assets/20240528.png" title="Image Title" alt="alt text" /><figcaption aria-hidden="true">alt text</figcaption></figure>]]></content>
    
    
    <summary type="html">ä½¿ç”¨å‘½ä»¤è¡Œæ‰¹é‡åˆ é™¤ Github ä»“åº“</summary>
    
    
    
    <category term="æŠ€æœ¯" scheme="http://blog.soul11201.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
  </entry>
  
  <entry>
    <title>Thrift  ä¸€ç§ åè®®-å·¥å…· è®¾è®¡æ–¹æ³•</title>
    <link href="http://blog.soul11201.com/2022/04/10/a-protocol-design-method/"/>
    <id>http://blog.soul11201.com/2022/04/10/a-protocol-design-method/</id>
    <published>2022-04-10T03:46:12.000Z</published>
    <updated>2024-07-02T14:57:05.151Z</updated>
    
    <content type="html"><![CDATA[<p><strong>åŒè¾¹é€šä¿¡æ˜¯ä¸ªå¤æ‚çš„é—®é¢˜</strong></p><h3 id="è¯·æ±‚---å“åº”">è¯·æ±‚ - å“åº”</h3><p>åŒè¾¹é€šä¿¡æœ¬è´¨æ¥è¯´æ˜¯<code>è¯·æ±‚-å“åº”</code>æ¨¡å‹ï¼Œä¸»åŠ¨æ–¹å‘å‡ºä¸€ä¸ªæœåŠ¡è¯·æ±‚ï¼Œè¢«åŠ¨æ–¹ç»™ä¸€ä¸ªæœåŠ¡ç»“æœåº”ç­”ã€‚äº‹å¾ˆç®€å•ï¼Œä½†å®ç°èµ·æ¥ç¡®å¾ˆè´¹åŠ²ã€‚</p><p>ä¼ è¾“å±‚åè®®æä¾›ä¿¡é“ä¼ è¾“æ¨¡å‹-å¦‚TCPï¼Œåº”ç”¨å±‚åè®®æä¾›ä¿¡æ¯æ ‡å‡†æ ¼å¼å°è£…æ¨¡å‹-å¦‚HTTP,RPCã€‚</p><p>Thriftçš„è®¾è®¡æ–¹å¼å¯¹åº”ç”¨å±‚åè®®è®¾è®¡æœ‰å¾ˆå¥½çš„å‚è€ƒæ„ä¹‰</p><h2 id="thrift">thrift</h2><figure class="highlight thrift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs thrift"><span class="hljs-class"><span class="hljs-keyword">service</span> <span class="hljs-title">HelloWorldService</span> </span>&#123;<br>  <span class="hljs-type">string</span> say(<span class="hljs-number">1</span>: <span class="hljs-type">string</span> username)<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleServer</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">ServerSocket</span> <span class="hljs-variable">serverSocket</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerSocket</span>(ServerConfig.SERVER_PORT);<br>        <span class="hljs-type">TServerSocket</span> <span class="hljs-variable">serverTransport</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TServerSocket</span>(serverSocket);<br>        HelloWorldService.<span class="hljs-type">Processor</span> <span class="hljs-variable">processor</span> <span class="hljs-operator">=</span><br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloWorldService</span>.Processor&lt;HelloWorldService.Iface&gt;(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloWorldServiceImpl</span>());<br><br>        TBinaryProtocol.<span class="hljs-type">Factory</span> <span class="hljs-variable">protocolFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TBinaryProtocol</span>.Factory();<br>        TSimpleServer.<span class="hljs-type">Args</span> <span class="hljs-variable">tArgs</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TSimpleServer</span>.Args(serverTransport);<br>        tArgs.processor(processor);<br>        tArgs.protocolFactory(protocolFactory);<br><br>        <span class="hljs-comment">// ç®€å•çš„å•çº¿ç¨‹æœåŠ¡æ¨¡å‹ ä¸€èˆ¬ç”¨äºæµ‹è¯•</span><br>        <span class="hljs-type">TServer</span> <span class="hljs-variable">tServer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TSimpleServer</span>(tArgs);<br>        System.out.println(<span class="hljs-string">&quot;Running Simple Server&quot;</span>);<br>        tServer.serve();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“åˆä»£ç ï¼Œä»æ¶æ„ä¸Šçœ‹æ‹†åˆ†äº†å››å±‚<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://juejin.cn/post/6844903622380093447">[1]</span></a></sup></p><ul><li>æœåŠ¡å±‚ <code>HelloWorldServiceImpl</code></li><li>å¤„ç†å±‚ <code>HelloWorldService.Processor</code></li><li>åè®®å±‚ <code>TBinaryProtocol.Factory</code></li><li>ä¼ è¾“å±‚ <code>TServerSocket</code></li></ul><p><img src="/imgs/thrift-arch-2022-04.png"title="https://www.cnblogs.com/mymelody/p/9474300.html" /></p><h2 id="åˆ†æ">åˆ†æ</h2><h3 id="ä¸ºä»€ä¹ˆæ˜¯-4-å±‚">ä¸ºä»€ä¹ˆæ˜¯ 4 å±‚</h3><p>æ­£å¸¸æ¥è¯´ä¸€ä¸ªç³»ç»Ÿä¼šè€ƒè™‘è¿™ä¹ˆå‡ ä¸ªæœ€è¿‘æœ¬çš„é—®é¢˜ï¼šå…·ä½“åŠŸèƒ½ã€ååé‡ã€ä½œä¸šæ—¶é—´,æ˜¾ç„¶thriftè€ƒè™‘åˆ°äº†ä¸‹é¢å‡ ä¸ªé—®é¢˜</p><ol type="1"><li><p>ä¼ è¾“ä¿¡é“æ˜¯ä»€ä¹ˆï¼Ÿç³»ç»Ÿååé‡å¦‚ä½•ï¼Ÿ</p></li><li><p>åè®®å°è£…æ ¼å¼æ˜¯ä»€ä¹ˆï¼Ÿ åè®®å°è£…æ ¼å¼æ˜¯å¦åˆæ³•ï¼Ÿ</p></li><li><p>ä¸€ä¸ªç³»ç»Ÿä¸å¯èƒ½åªæœ‰ä¸€ä¸ªæœåŠ¡ï¼Œä¸åŒæœåŠ¡è¯·æ±‚çš„æœåŠ¡å¦‚ä½•è¿›è¡Œ è·¯ç”±åˆ†å‘ï¼Ÿ</p></li><li><p>å…·ä½“æœåŠ¡å“åº”æ˜¯ä»€ä¹ˆï¼Œä»¥ä½•ç§å°è£…æ ¼å¼è¿”å›ï¼Ÿ</p></li></ol><h3 id="è®¾è®¡è€…-ä½¿ç”¨è€…">è®¾è®¡è€…-ä½¿ç”¨è€…</h3><p>ä¸€ä¸ªç³»ç»Ÿæ°¸è¿œå¯ä»¥ä»è®¾è®¡è€…ä¸ä½¿ç”¨è€…ä¸¤ä¸ªè§†è§’å»çœ‹ã€‚thriftä¹Ÿä¸ä¾‹å¤–ï¼Œæš‚æ—¶å«åš<code>åè®®æ¡†æ¶è®¾è®¡è€…</code>ä¸<code>åè®®ä½¿ç”¨è€…</code>ï¼Œå¤„ç†å±‚æ˜¯ä¸¤è€…çš„è¾¹ç•Œï¼Œåˆ©ç”¨<code>é’©å­ï¼ˆæ³¨å…¥ï¼‰</code>è¿›è¡Œå…³æ³¨ç‚¹åˆ†ç¦»ã€‚</p><ul><li><p>åè®®æ¡†æ¶è®¾è®¡è€…</p><p>å…³æ³¨çš„æ•´ä½“çš„æ•ˆç‡ååé‡ã€idl compilerå·¥å…·ï¼Œ</p></li><li><p>åè®®ä½¿ç”¨è€…</p><p>å…³æ³¨çš„æ˜¯å·¥å…·æ˜“ç”¨æ€§ã€æ¥å…¥æˆæœ¬ã€‚</p></li></ul><h3 id="æ ‡å‡†---å·¥å…·">æ ‡å‡† - å·¥å…·</h3><p>ç›¸æ¯”HTTP,thriftåœ¨æ¨¡å‹ä¸Šæ¥è¯´æ”¹è¿›ä¸Šè¿›æ­¥ä¸å¤§ï¼Œéƒ½åœ¨åº”ç”¨å±‚ã€‚ä½†é€šè¿‡å¯¹idlå¢åŠ çº¦æŸï¼Œå¼•å…¥å·¥å…·ï¼Œåœ¨å·¥ç¨‹ä¸Šå‰è¿›äº†ä¸€æ­¥ï¼Œå½¢æˆæ¥å£æè¿°ç»Ÿä¸€è¯­è¨€ï¼Œå‡å°‘æ²Ÿé€šæ­§ä¹‰ã€‚</p><h3 id="è®¾è®¡å·¥å…·ç•™æ„çš„å…¶ä»–ç‚¹">è®¾è®¡å·¥å…·ç•™æ„çš„å…¶ä»–ç‚¹</h3><ul><li><p>å­¦ä¹ æˆæœ¬</p><p>å¸¦æ¥é¢å¤–çš„é€šä¿¡æ¨¡å‹ä¸å·¥å…·å­¦ä¹ æˆæœ¬</p></li><li><p>æ¡¥æ¥</p><p>ä»¥å¼€å¤´ä»£ç ä¸ºä¾‹ï¼Œidlç”Ÿæˆçš„ä»£ç ä»ä¸€ä¸ªé¡¹ç›®è§’åº¦æ¥è¯´æ˜¯åœ¨æ¥å£å±‚ï¼Œæ¥å£å±‚æœ‰ä¸€å¥—è‡ªå·±çš„è®¾è®¡æ¨¡å‹ç†å¿µï¼ŒæœåŠ¡å±‚ä½¿ç”¨çš„å·¥å…·æœ‰ä¸€å¥—å·¥å…·ç†å¿µã€‚è¿™å±‚ä»£ç çš„æ¡¥æ¥ï¼Œæœ¬è´¨æ˜¯ä¸¤ç§ç†å¿µçš„å·®å¼‚å¼¥åˆ</p></li><li><p>å…¼å®¹æ€§</p><p>åˆ¨é™¤æ ‡å‡†ç‰ˆæœ¬å‡çº§å¯¼è‡´çš„å‰å‘ä¸å…¼å®¹å¤–ï¼Œå·¥å…·æœ¬èº«ä¸€å®šä¾èµ–å…¶ä»–å·¥å…·ï¼Œå·¥å…·é›†åˆèå…¥åˆ°å¦å¤–çš„å·¥å…·é›†åˆæ—¶å°±ä¼šé‡åˆ°ç‰ˆæœ¬å†²çªé—®é¢˜ã€‚</p></li></ul><h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1"class="footnote-text"><span>https://juejin.cn/post/6844903622380093447<a href="#fnref:1" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:2"class="footnote-text"><span>https://www.cnblogs.com/mymelody/p/9474300.html<a href="#fnref:2" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:3"class="footnote-text"><span>https://www.bilibili.com/video/BV1aL4y157s7<a href="#fnref:3" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:4"class="footnote-text"><span>https://www.bilibili.com/video/BV1j44y1q7fy<a href="#fnref:4" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:5" class="footnote-text"><span>https://thrift.apache.org/<a href="#fnref:5" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„</summary>
    
    
    
    <category term="æŠ€æœ¯" scheme="http://blog.soul11201.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Thrift" scheme="http://blog.soul11201.com/tags/Thrift/"/>
    
  </entry>
  
  <entry>
    <title>è¿å› Hexo</title>
    <link href="http://blog.soul11201.com/2022/03/26/blog-migration/"/>
    <id>http://blog.soul11201.com/2022/03/26/blog-migration/</id>
    <published>2022-03-26T11:18:34.000Z</published>
    <updated>2024-07-02T14:27:27.607Z</updated>
    
    <content type="html"><![CDATA[<h2 id="hexo-2-jekyll">Hexo 2 Jekyll</h2><p>Hexoæ˜¯æœ€æ—©ä½¿ç”¨çš„å·¥å…·ï¼Œæ ·å¼ç²¾ç¾ï¼Œä¸»é¢˜åˆ‡æ¢ä¹Ÿæ˜¯å¾ˆæ–¹ï¼Œä¾¿éƒ¨ç½²å·¥å…·å‹å¥½ã€‚å¹´è½»æ€»çˆ±æŠ˜è…¾ï¼Œ16å¹´åˆ‡æ¢åˆ°äº†Jekyllã€‚Jekeyllä¸»é¢˜å¾ˆå¤šï¼Œä½†åˆ‡æ¢éº»çƒ¦ã€‚æœ¬åœ°æ„å»ºé¢„è§ˆï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ€»æ˜¯è«åçš„å‡ºä¸€äº›é—®é¢˜ï¼Œå°é—®é¢˜ä¸æ­»äººä½†å¾ˆæ¶å¿ƒäººã€‚</p><h2 id="jekyll-2-org">Jekyll 2 Org</h2><p>æœ‰æ®µæ—¶é—´ç”¨ Emacs å¾ˆä¸Šå¤´ï¼Œ æ„Ÿè§‰ Markdown å¥½éš¾ç”¨ï¼ŒæŠ˜è…¾äº†ä¸€æ®µæ—¶é—´Orgã€‚DIY å‹å¥½ï¼Œè¿ç»´éƒ¨ç½²ç¨å¾®æœ‰ç‚¹éº»çƒ¦ã€‚</p><h2 id="hexo">Hexo</h2><p>å¯¹äºå·¥å…·ç®€å•å‰æ®µæ—¶é—´å°±æƒ³ç€ç‰µå›æ¥äº†ï¼Œè¿™ä¹ˆå¤šå¹´äº†ï¼Œç‰µå›æ¥ä¹Ÿæ¯ä¸ªå¤´ç»ªï¼Œå¿ƒçƒ¦æ„ä¹±ï¼Œå¾€åæ‹–å»¶~</p><p>æœ€è¿‘çœ‹ Manjaro ç”µæŠ¥ç¾¤ çš„åŠé€€æ–‡https://blog.zhullyb.top/2021/01/01/Why-I-dont-recommend-Manjaro/å‘ç°è¿™ä¸ªHexoä¸»é¢˜ä¸é”™ï¼ŒFluid<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://hexo.fluid-dev.com/docs/guide/#slogan-%E6%89%93%E5%AD%97%E6%9C%BA">[3]</span></a></sup>æ–‡æ¡£ä¹Ÿä¸é”™ï¼Œç¬é—´æ„Ÿè§‰æœ‰ç‚¹ä¸–å¤–æ¡ƒæºäººäº†ï¼Œè¶ç€æœ‰ç‚¹å¿ƒæ°”ï¼Œèµ¶ç´§æŠ˜è…¾ä¸‹ï¼Œåˆ‡æ¢å›æ¥ã€‚</p><p>è€äºŒæœ€å¥½çš„ç­–ç•¥å°±æ˜¯æ¨¡ä»¿ï¼Œæ©ï¼Œå¼€å¹²ï¼ŒHexo + Fluid + Waline</p><p>Hexo å‡çº§<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://coldnew.github.io/hexo-org-example/2017/03/05/getting-started-with-hexo-and-org-mode/">[2]</span></a></sup><sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://leimingshan.com/posts/d9017f30/">[4]</span></a></sup></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs sh">// é…ç½®é•œåƒæº<br>&gt; npm config <span class="hljs-built_in">set</span> registry https://registry.npmmirror.com<br><br>//ä»¥ä¸‹æŒ‡ä»¤å‡åœ¨Hexoç›®å½•ä¸‹æ“ä½œï¼Œå…ˆå®šä½åˆ°Hexoç›®å½•<br>//æŸ¥çœ‹å½“å‰ç‰ˆæœ¬ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦å‡çº§<br>&gt; hexo version<br><br>//å…¨å±€å‡çº§hexo-cli<br>&gt; npm i hexo-cli -g<br><br>//å†æ¬¡æŸ¥çœ‹ç‰ˆæœ¬ï¼Œçœ‹hexo-cliæ˜¯å¦å‡çº§æˆåŠŸ<br>&gt; hexo version<br><br>//å®‰è£…npm-checkï¼Œè‹¥å·²å®‰è£…å¯ä»¥è·³è¿‡<br>&gt; npm install -g npm-check<br><br>//æ£€æŸ¥ç³»ç»Ÿæ’ä»¶æ˜¯å¦éœ€è¦å‡çº§<br>&gt; npm-check<br><br>//å®‰è£…npm-upgradeï¼Œè‹¥å·²å®‰è£…å¯ä»¥è·³è¿‡<br>&gt; npm install -g npm-upgrade<br><br>//æ›´æ–°package.json<br>&gt; npm-upgrade<br><br>//æ›´æ–°å…¨å±€æ’ä»¶<br>&gt; npm update -g<br><br>//æ›´æ–°ç³»ç»Ÿæ’ä»¶<br>&gt; npm update --save<br><br>//å†æ¬¡æŸ¥çœ‹ç‰ˆæœ¬ï¼Œåˆ¤æ–­æ˜¯å¦å‡çº§æˆåŠŸ<br>&gt; hexo version<br><br>// å®‰è£… hexo ä¾èµ–<br>&gt; npm i -d<br><br>// æ›´æ–° hexo ä¾èµ–<br>&gt; npm update -d<br></code></pre></td></tr></table></figure><p>Hexo + Fluid + Waline + Emacs + Markdownå°±æ˜¯ä»¥åçš„å†™å­—åŸºæœ¬å·¥å…·äº†ã€‚</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1"class="footnote-text"><span>http://mpwang.github.io/2019/02/13/how-to-write-hexo-blog-with-org-mode/<a href="#fnref:1" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:2"class="footnote-text"><span>https://coldnew.github.io/hexo-org-example/2017/03/05/getting-started-with-hexo-and-org-mode/<a href="#fnref:2" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:3"class="footnote-text"><span>https://hexo.fluid-dev.com/docs/guide/#slogan-%E6%89%93%E5%AD%97%E6%9C%BA<a href="#fnref:3" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:4"class="footnote-text"><span>https://leimingshan.com/posts/d9017f30/<a href="#fnref:4" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">ğŸ‘Œ</summary>
    
    
    
    <category term="æŠ€æœ¯" scheme="http://blog.soul11201.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="hexo" scheme="http://blog.soul11201.com/tags/hexo/"/>
    
    <category term="jekyll" scheme="http://blog.soul11201.com/tags/jekyll/"/>
    
    <category term="emacs" scheme="http://blog.soul11201.com/tags/emacs/"/>
    
    <category term="waline" scheme="http://blog.soul11201.com/tags/waline/"/>
    
    <category term="org" scheme="http://blog.soul11201.com/tags/org/"/>
    
  </entry>
  
  <entry>
    <title>å·¥ä½œå±…ä½è¯</title>
    <link href="http://blog.soul11201.com/2022/03/25/gongzuojuzhuzheng/"/>
    <id>http://blog.soul11201.com/2022/03/25/gongzuojuzhuzheng/</id>
    <published>2022-03-25T05:09:03.000Z</published>
    <updated>2024-07-02T14:25:48.479Z</updated>
    
    <content type="html"><![CDATA[<p><ahref="https://fw.bjrcgz.gov.cn/person-platform/#/person-platform/overview">äººæ‰ä¸šåŠ¡åŠç†å¹³å°</a></p><h2 id="ç³»ç»Ÿè€æ—§å‡çº§ç¼“æ…¢">ç³»ç»Ÿè€æ—§ï¼Œå‡çº§ç¼“æ…¢</h2><p>20å¹´9æœˆä»½ï¼Œå…¬å¸ç»™å‘˜å·¥ç»Ÿä¸€åŠç†å·¥ä½œå±…ä½è¯ï¼Œè¿™é¡¹ä¸šåŠ¡å·²æš‚åœåŠç†æœ‰ä¸¤å¹´å·¦å³äº†ã€‚åˆ†æ‰¹åŠç†ï¼Œæ¯ä¸¤å‘¨ä¸€æ‰¹ã€‚æœ¬æ‰¹æ¬¡æ²¡æœ‰å‡‘é›†å¤Ÿææ–™çš„ï¼Œä¸‹æ‰¹æ¬¡ç»§ç»­ã€‚å…¬å¸æŠ•å…¥äººåŠ›å·¨å¤§ï¼Œè‡ªå·±å‰å‰ååå¼„äº†æœ‰å°†è¿‘ä¸€ä¸ªæœˆçš„æ—¶é—´æ‰æŠŠææ–™å‡‘å…¨ï¼Œå”¯ä¸€çš„æ„Ÿè§‰æ—¶æ”¿åŠ¡ä¿¡æ¯ç³»ç»Ÿä¸æ˜¯ä¸€èˆ¬çš„éš¾ç”¨ã€‚</p><p>æ”¶é›†çš„ææ–™åŸºæœ¬å…¨æ˜¯ç¨æ”¶ã€ç¤¾ä¿ã€å±…ä½ã€å­¦å†å­¦ä½ã€å©šå§»ã€èŒç§°ç­‰ç›¸å…³çš„ææ–™ï¼Œæœ‰äº›ç³»ç»Ÿå½“æ—¶æ¯”è¾ƒè€æ—§åªæ”¯æŒIE 8ï¼Œæå¾—æˆ‘è¿˜è£…äº†ä¸ªè™šæ‹Ÿæœºï¼Œåœ¨é‡Œè£…äº†ä¸€ä¸ªå·²ç»åºŸå¼ƒå¥½å¤šå¹´ä¸ç”¨çš„ XPç³»ç»Ÿè·‘IEã€‚</p><p>å‰æ®µæ—¶é—´æ¢äº†å·¥ä½œï¼Œå·¥ä½œå±…ä½è¯éœ€è¦åŠç†äº¤æ¥ï¼ŒæŒ‰ç…§å…¬å¸çš„è¡Œæ”¿åŒäº‹çš„æŒ‡å—æ“ä½œï¼Œå‘ç°ç³»ç»Ÿæ”¹è¿›ä¸å°‘ã€‚é¦–å…ˆç³»ç»Ÿå‡çº§äº†ï¼Œç™»å½•æ–¹å¼ä¹Ÿä¾¿æ·ä¸å°‘ï¼Œæ”¯æŒåŒ»ä¿å¡ã€åŒ—äº¬é€šã€å¾®ä¿¡ã€æ”¯ä»˜å®ç­‰å¤šç§å¸¸è§çš„æ–¹å¼ã€‚ä½†æ˜¯è¿›æ¥åå‘ç°åŸå…ˆçš„èµ„æ–™éƒ½ä¸¢äº†ï¼Œæœ€åä»åŒäº‹å¤„å¾—çŸ¥ï¼Œ21å¹´7æœˆä»½ç³»ç»Ÿå‡çº§çš„æ—¶å€™ï¼Œæ­¤å‰æ‰€æœ‰ææ–™å…¨éƒ¨ä¸¢å¤±ï¼Œéœ€è¦è‡ªè¡Œè¡¥å……ï¼Œ<code>å›§</code>ã€‚</p><h2 id="äº‹è™½å°ä¾®è¾±æ€§å¤§">äº‹è™½å°ï¼Œä¾®è¾±æ€§å¤§</h2><p>æ—¶é—´æ‹–çš„ä¸€èˆ¬éå¸¸é•¿ï¼Œç¤¾ä¿ã€ç¨æ”¶å…¬å¸äº¤æ›¿ï¼Œå‰é¢åšå®Œå…¬å¸å…³è”ï¼Œåé¢ç­‰ä¸€ä¸ªæœˆåå†è¡¥å……ææ–™ï¼Œæ‹–æ‹–æ‹‰æ‹‰ï¼Œæ¯«æ— æ•ˆç‡ï¼Œå‰é¢çœ‹çš„æŒ‡å¯¼æ–‡æ¡£ï¼Œåé¢ä¼°è®¡è¿˜éœ€è¦å†çœ‹ä¸€è¾¹ã€‚ä»æ€»è€—è´¹æ—¶é—´ä¸Šæ¥ï¼Œå¤§æ¦‚éœ€è¦16-24å°æ—¶ã€‚æˆ‘çš„åŒäº‹å°±å› ä¸ºè¿™ç©æ„å¤æ‚ï¼Œæ¢å·¥ä½œåå°±ä¸€ç›´æ²¡å¼„ã€‚æ¯æ¬¡éœ€è¦å‡†å¤‡ææ–™ï¼Œç”µå­ç‰ˆçš„å…ˆæ‰“å°ã€æ‰¾äººç›–ç« ã€å†æ‰«æç”µå­åŒ–ï¼Œè¿™ä¸ªæ“ä½œä¹Ÿè·Ÿåƒå±ä¸€æ ·è ¢ã€‚ç»è¿‡å¤šæ¬¡æŠ˜ç£¨éƒ½å¿«æ‚£ä¸Šæ”¿åŠ¡åŠç†PTSDäº†ã€‚</p><h2 id="ä¿¡æ¯ç³»ç»ŸåŸºç¡€å»ºè®¾é—®é¢˜å¤š">ä¿¡æ¯ç³»ç»ŸåŸºç¡€å»ºè®¾é—®é¢˜å¤š</h2><p>ä»æ­£å¸¸äººçš„ç†è§£ï¼Œç¨æ”¶ã€ç¤¾ä¿ã€å±…ä½ã€å­¦å†å­¦ä½ã€å©šå§»ã€èŒç§°ã€å¾ä¿¡ã€æˆ¿äº§ã€åŒ»ç–—ã€è¡Œç¨‹æµè°ƒè¿™äº›ä¸ªäººä¿¡æ¯èµ„æ–™å…¶å®éƒ½åœ¨å›½å®¶çš„æ•°æ®ç³»ç»Ÿä¸­ï¼Œä¸ºå•¥åŠç†äº‹æƒ…çš„æ—¶å€™æ•ˆç‡æ€»æ˜¯è¿™ä¹ˆä½å‘¢ï¼Ÿ</p><p>åŸºæœ¬å°±æ˜¯ä¿¡æ¯ç³»ç»Ÿå»ºè®¾çš„ç¼ºå¤±ã€‚</p><p>é¦–å…ˆè¿™äº›æ•°æ®åœ¨æ”¿åºœå†…éƒ¨å…¶å®æ˜¯ä¸äº’é€šçš„ï¼Œä»æ¯æ¬¡åŠç†äº‹æƒ…éƒ½éœ€è¦æä¾›æˆ·å£æœ¬é¦–é¡µã€æœ¬äººé¡µé¢ï¼Œç»“å©šè¯ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ä¿¡æ¯æ—¶è·¨èŒèƒ½éƒ¨é—¨ä¸é€šçš„ï¼ŒåŒ»ç–—ä¿¡æ¯ï¼Œä½ ä¼šå‘ç°å„å®¶å…¬ç«‹åŒ»é™¢æ˜¯æ ¹æœ¬ä¸äº’é€šçš„ï¼Œæœ‰å¾ˆå¤šé‡å¤æ£€æŸ¥çš„é—®é¢˜<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="2022å¹´3æœˆ1æ—¥èµ·çœ‹ç—…æ¢åŒ»é™¢ä¸éœ€é‡å¤æ£€æŸ¥ https://www.thepaper.cn/newsDetail_forward_16905493">[1]</span></a></sup>ã€‚æ”¿åºœéƒ¨é—¨è·¨åœ°åŸŸï¼Œè·¨èŒèƒ½æ•°æ®å¹¶æ²¡æœ‰å¾ˆæœ‰æ•ˆçš„æ‰“é€šï¼Œå¯¼è‡´åŠäº‹æ•ˆç‡å¾ˆä½ã€‚å½“ç„¶ä¹Ÿæœ‰äº›æ”¹è¿›çš„åœ°æ–¹ï¼Œæµè°ƒï¼Œäº¤é€šè¿ç« ä¿¡æ¯åŸºæœ¬ä¸Šæ‰“é€šäº†ï¼Œèº«ä»½è¯å¯ä»¥å¼‚åœ°åŠç†äº†ï¼Œä½†ç‘œä¸æ©ç‘•ã€‚</p><p>å…¶æ¬¡ï¼Œè¿™äº›æ•°æ®å¦‚ä½•è¢«å¼€æ”¾ä½¿ç”¨ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨åšçš„å¹¶ä¸å¥½ã€‚ä½¿ç”¨çš„è¿‡ç¨‹ä¸­æ˜æ˜¾èƒ½æ„Ÿè§‰å‡ºæ¥ï¼Œä»–ä»¬ä¹‹é—´æœ‰<code>ä¿¡æ¯æµé¸¿æ²Ÿ</code>ã€‚è€Œå¡«å¹³é¸¿æ²Ÿçš„æ–¹å¼å°±æ˜¯æ¯ä¸€ä¸ªäººåœ¨ä¸åŒçš„ç³»ç»Ÿä¹‹é—´æ¥å›è…¾æŒªï¼Œæµªè´¹æ—¶é—´ï¼Œåœ¨ä¸€ä¸ªç³»ç»ŸæŸ¥è¯¢ã€ä¸‹è½½ã€æ‰“å°ã€æ‰«æç”µå­åŒ–ï¼Œåœ¨å¦å¤–ä¸€ä¸ªç³»ç»Ÿæäº¤ã€å®¡æ ¸ã€å…¥ç³»ç»Ÿã€‚</p><p>ç³»ç»Ÿé—´ä¿¡æ¯æµåˆæ³•æˆæƒä½¿ç”¨æœ‰æ—¶å€™è¯´ç®€å•ç¡®å®ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åšå¥½ä¸¤ä»¶äº‹æƒ…- è¯·æ±‚è·å–æ•°æ®çš„äººæ˜¯æœ‰æƒè·å–çš„ - æäº¤æ•°æ®çš„äººæ•°æ®å°±æ˜¯ä»–æœ¬äººçš„æ•°æ®</p><p>å‰©ä¸‹çš„é ä¿¡æ¯ç³»ç»Ÿä¹‹é—´æ‰“é€šå°±å¯ä»¥äº†ï¼Œäººåœ¨ä¿¡æ¯ç³»ç»Ÿä¸­æ‰€åšçš„äº‹æƒ…å…¶å®åªæ˜¯æˆæƒç»™ä¿¡æ¯ç³»ç»Ÿä»£ç†è€Œå·²ã€‚</p><p>å¹³è¡¡å¥½æˆæƒä½¿ç”¨ä¸å®‰å…¨é—®é¢˜å¾ˆéš¾ã€‚æ–¹å¼å¯èƒ½ä¹Ÿæœ‰å¾ˆå¤šæ–¹å¼å»è§£å†³ï¼Œä½†è‚¯å®šä¸æ˜¯ç°åœ¨è¿™ä¹ˆæ„šè ¢çš„æ–¹å¼ã€‚</p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1"class="footnote-text"><span>2022å¹´3æœˆ1æ—¥èµ·çœ‹ç—…æ¢åŒ»é™¢ä¸éœ€é‡å¤æ£€æŸ¥https://www.thepaper.cn/newsDetail_forward_16905493<a href="#fnref:1" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">ğŸ˜®â€ğŸ’¨ åƒåœ¾çš„æ”¿åŠ¡ä¿¡æ¯ç³»ç»Ÿ</summary>
    
    
    
    <category term="éšç¬”" scheme="http://blog.soul11201.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>manjaro ä½¿ç”¨æ”»ç•¥</title>
    <link href="http://blog.soul11201.com/2022/03/18/manjaro/"/>
    <id>http://blog.soul11201.com/2022/03/18/manjaro/</id>
    <published>2022-03-18T13:02:56.000Z</published>
    <updated>2022-04-26T03:55:36.141Z</updated>
    
    <content type="html"><![CDATA[<h2 id="yay">yay</h2><h3 id="pkg-æ„å»ºç›®å½•">pkg æ„å»ºç›®å½•</h3><pre><code class="hljs">`~/.cache/yay/pkg/`</code></pre><p>å®‰è£…è¿‡ç¨‹æœ‰æ—¶ä¼šå‡ºç°é—®é¢˜ï¼Œæ‰‹å·¥ä»‹å…¥ï¼Œè§£å†³é€Ÿåº¦ä¼šå¿«ä¸å°‘ã€‚å…ˆå‰è£…drawioçš„æ—¶å€™ç»å¸¸ä¸‹è½½ä¸€èˆ¬æ—§æŒ‚äº†ï¼Œæµè§ˆå™¨ä¸‹è½½å®Œåcopyåˆ°ç›®å½• é‡æ–°yay å¯ä»¥ç»§ç»­å¾€åæ‰§è¡Œã€‚</p><h3 id="å®‰è£…è¿‡ç¨‹ä¿®æ”¹-pkgbuild">å®‰è£…è¿‡ç¨‹ä¿®æ”¹ PKGBUILD</h3><p>éœ€è¦è”å…¬å¸VPNï¼Œæœ¬æ¥ç¢ç£¨ openconnectåº”è¯¥èƒ½è§£å†³é—®é¢˜ï¼Œæ²¡æƒ³åˆ°æŸæœè‡ªå·±å•ç‹¬ç©äº†ä¸€å¥—ã€‚å®‰è£…EeasyConnectæ—¶ï¼Œå®˜æ–¹æä¾›çš„æœ€æ–°çš„åŒ…ç‰ˆæœ¬å·æ²¡æœ‰å˜ï¼Œä½†æ˜¯md5 å‘ç”Ÿäº†å˜åŒ–ï¼Œä¸çŸ¥é“ä»–ä»¬åœ¨æä»€ä¹ˆé¬¼ã€‚</p><p>ç€æ€¥ç”¨ï¼Œéœ€è¦ä¿®æ”¹PKGBUILD å°è¯•äº†ä¸¤ä¸ªæ²¡æœ‰æ•ˆæœçš„è§£å†³æ–¹æ¡ˆ<code>yay --editmenu --save</code><code>yay -G &lt;pkgname&gt;</code>ï¼Œç›´æ¥è¿›å…¥æ„å»ºç›®å½•åï¼Œæ‰‹åŠ¨ä¿®æ”¹æ„å»ºè„šæœ¬å¿«ï¼Œæ”¹å®Œåç¼–è¯‘ã€å®‰è£…ä¸€åˆ†é’Ÿä¸åˆ°è§£å†³é—®é¢˜</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd .cache/yay/easyconnect<br>md5sum <br>makepkg -si<br></code></pre></td></tr></table></figure><h3 id="æ¸…ç¼“å­˜">æ¸…ç¼“å­˜</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">yay -Sc<br><br>pacman -Qqtd| sudo pacman -Rs -<br><br>paru -Sc<br></code></pre></td></tr></table></figure><p>è·‘äº†æœ‰ä¸€å¹´å¤šäº†å‰æ®µæ—¶é—´çœ‹ç¡¬ç›˜ä¸è¶³äºŒåä¸ªGäº†ï¼Œæ¸…æ¸…ç¼“å­˜èŠ‚çº¦äº† 80G</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs log">[2020-11-04T19:24:07+0800] [ALPM] running &#x27;update-mime-database.hook&#x27;...<br>[2020-11-04T19:28:49+0800] [PACMAN] Running &#x27;pacman -Syyu&#x27;<br></code></pre></td></tr></table></figure><h2 id="backup">backup</h2><h3 id="ç³»ç»Ÿå¼•å¯¼ä¿®å¤">ç³»ç»Ÿå¼•å¯¼ä¿®å¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">lsblk -f<br>vim /etc/fstab<br>mkinitcpio -P<br><br>grub-install --target=x86_64-efi --efi-directory=/boot/efi --removable --recheck --force<br>update-grub<br></code></pre></td></tr></table></figure><h2 id="virtualbox">VirtualBox</h2><h3 id="virtualbox-cannot-register-the-hard-disk-è§£å†³åŠæ³•-1">VirtualBoxâ€“ Cannot register the hard disk è§£å†³åŠæ³•<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://stackoverflow.com/questions/44114854/virtualbox-cannot-register-the-hard-disk-already-exists">[1]</span></a></sup></h3><pre><code class="hljs">File -&gt; Virtual Media Manager -&gt; Removed existing images (note, I removed them only from the registry).</code></pre><h3 id="å‹ç¼©-vdi-ç£ç›˜å¤§å°">å‹ç¼© vdi ç£ç›˜å¤§å°</h3><p>vmdk æ ¼å¼ä¸æ”¯æŒï¼Œvdi å‹ç¼©å‰ï¼Œéœ€è¦å…ˆè¿›å…¥è™šæ‹Ÿæœºä¸­æŠŠæ²¡æœ‰ä½¿ç”¨çš„ç£ç›˜ä½ç½®å¡«å…… 0</p><p>windowså·¥å…·ï¼š<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://www.appinn.com/sdelete-for-windows/">[2]</span></a></sup></p><pre><code class="hljs">https://docs.microsoft.com/en-us/sysinternals/downloads/sdelete</code></pre><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sdelete64.exe -z c:  <span class="hljs-comment"># å¯¹ C ç›˜å‰©ä½™ç©ºé—´å†™é›¶ï¼Œé€‚åˆè™šæ‹Ÿç£ç›˜ä¼˜åŒ–</span><br></code></pre></td></tr></table></figure><p>Linux å·¥å…·ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/zero of=./1.img bs=102400 status=progress <br></code></pre></td></tr></table></figure><p>Manjaro å®¿ä¸»æœºä¸­æ‰§è¡Œå¦‚ä¸‹å‹ç¼©æŒ‡ä»¤</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">VBoxManage modifymedium  docs.vdi --compact<br></code></pre></td></tr></table></figure><h2 id="vmware">vmware</h2><h2 id="wayland">Wayland</h2><p>wayland<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://bbs.archlinuxcn.org/viewtopic.php?id=11294">[3]</span></a></sup><sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://fcitx-im.org/wiki/Setup_Fcitx_5">[4]</span></a></sup><sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://wiki.archlinux.org/title/wayland#Qt">[5]</span></a></sup><sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://batsov.com/articles/2021/12/19/building-emacs-from-source-with-pgtk/">[6]</span></a></sup></p><h3 id="fcitx5">fcitx5</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment">#/etc/profile</span><br><span class="hljs-built_in">export</span> <span class="hljs-attribute">GTK_IM_MODULE</span>=fcitx5<br><span class="hljs-built_in">export</span> <span class="hljs-attribute">QT_IM_MODULE</span>=fcitx5<br><span class="hljs-built_in">export</span> <span class="hljs-attribute">XMODIFIERS</span>=<span class="hljs-string">&quot;@im=fcitx5&quot;</span><br></code></pre></td></tr></table></figure><h3 id="firefox-thunderbird">Firefox thunderbird</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">MOZ_ENABLE_WAYLAND=1<br></code></pre></td></tr></table></figure><h3 id="chromium">chromium</h3><pre><code class="hljs">--ozone-platform-hint=autovivaldi-stable --ozone-platform-hint=autochrome://flags è£é¢å°±å¯ä»¥é–‹å•“wayland</code></pre><h3 id="qt">QT</h3><pre><code class="hljs"> QT_QPA_PLATFORM=&quot;wayland;xcb&quot;</code></pre><h3 id="emacs">Emacs</h3><pre><code class="hljs">./configure --enable-largefile --with-all --with-json --with-imagemagick --with-threads --with-pgtk --with-native-compilation --with-native-image-api</code></pre><h2 id="ref">Ref</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1"class="footnote-text"><span>https://stackoverflow.com/questions/44114854/virtualbox-cannot-register-the-hard-disk-already-exists<a href="#fnref:1" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:2"class="footnote-text"><span>https://www.appinn.com/sdelete-for-windows/<a href="#fnref:2" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:3"class="footnote-text"><span>https://bbs.archlinuxcn.org/viewtopic.php?id=11294<a href="#fnref:3" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:4"class="footnote-text"><span>https://fcitx-im.org/wiki/Setup_Fcitx_5<a href="#fnref:4" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:5"class="footnote-text"><span>https://wiki.archlinux.org/title/wayland#Qt<a href="#fnref:5" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:6"class="footnote-text"><span>https://batsov.com/articles/2021/12/19/building-emacs-from-source-with-pgtk/<a href="#fnref:6" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li></ol></div></section>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;yay&quot;&gt;yay&lt;/h2&gt;
&lt;h3 id=&quot;pkg-æ„å»ºç›®å½•&quot;&gt;pkg æ„å»ºç›®å½•&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs&quot;&gt;`~/.cache/yay/pkg/`&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®‰è£…è¿‡ç¨‹æœ‰æ—¶ä¼šå‡ºç°é—®é¢˜ï¼Œæ‰‹å·¥ä»‹å…¥ï¼Œè§£å†³é€Ÿåº¦ä¼šå¿«ä¸å°‘ã€‚</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç”Ÿæ´»åœ¨è¿™ä¸ªæ—¶ä»£é¢ä¸´çš„é—®é¢˜</title>
    <link href="http://blog.soul11201.com/2022/03/04/the-questions-we-faced-and-boring/"/>
    <id>http://blog.soul11201.com/2022/03/04/the-questions-we-faced-and-boring/</id>
    <published>2022-03-04T03:22:55.000Z</published>
    <updated>2024-07-02T14:56:49.060Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»å‡ ä»¶å°äº‹æƒ…è¯´èµ·">ä»å‡ ä»¶å°äº‹æƒ…è¯´èµ·</h2><h3 id="ç‡ƒæ°”ç¶">ç‡ƒæ°”ç¶</h3><h3 id="section"></h3><p><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="http://opinion.people.com.cn/n1/2018/0330/c1003-29897549.html">[2]</span></a></sup></p><p><sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><spanclass="hint--top hint--rounded"aria-label="https://www.zhihu.com/question/519964076">[3]</span></a></sup></p><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:2"class="footnote-text"><span>http://opinion.people.com.cn/n1/2018/0330/c1003-29897549.html<a href="#fnref:2" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li><li><span id="fn:3"class="footnote-text"><span>https://www.zhihu.com/question/519964076<a href="#fnref:3" rev="footnote" class="footnote-backref">â†©ï¸</a></span></span></li></ol></div></section>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä»å‡ ä»¶å°äº‹æƒ…è¯´èµ·&quot;&gt;ä»å‡ ä»¶å°äº‹æƒ…è¯´èµ·&lt;/h2&gt;
&lt;h3 id=&quot;ç‡ƒæ°”ç¶&quot;&gt;ç‡ƒæ°”ç¶&lt;/h3&gt;
&lt;h3 id=&quot;section&quot;&gt;&lt;/h3&gt;
&lt;p&gt;&lt;sup id=&quot;fnref:2&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn:2&quot; rel=&quot;</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://blog.soul11201.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>Go è¯­è¨€å­¦ä¹ ç¬”è®°</title>
    <link href="http://blog.soul11201.com/2022/01/14/Go-Notes/"/>
    <id>http://blog.soul11201.com/2022/01/14/Go-Notes/</id>
    <published>2022-01-14T04:36:17.000Z</published>
    <updated>2024-07-02T13:21:34.835Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å·¥å…·é“¾">å·¥å…·é“¾</h2><h3 id="gopath">GOPATH</h3><p><code>go env|grep GOPATH</code></p><h3 id="go-mod">go mod</h3><figure><img src="/imgs/2022-04-09_17-24.png" title="a" alt="go help modules" /><figcaption aria-hidden="true">go help modules</figcaption></figure><h3 id="go-mod-ä»£ç†è®¾ç½®">go mod ä»£ç†è®¾ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">go <span class="hljs-built_in">env</span> -w GO111MODULE=on<br>go <span class="hljs-built_in">env</span> -w GOPROXY=https://goproxy.cn,direct<br>go <span class="hljs-built_in">env</span> -w GOPRIVATE=code.devops.xiaohongshu.com <br>git config --global url.<span class="hljs-string">&quot;git@code.devops.xiaohongshu.com:&quot;</span>.insteadof <span class="hljs-string">&quot;http://code.devops.xiaohongshu.com/&quot;</span><br>git config --global url.<span class="hljs-string">&quot;git@code.devops.xiaohongshu.com:&quot;</span>.insteadof <span class="hljs-string">&quot;https://code.devops.xiaohongshu.com/&quot;</span><br></code></pre></td></tr></table></figure><h3 id="goland">Goland</h3><h4 id="å¯¹-go-get-å¼•å…¥çš„åŒ…ä¸èƒ½è‡ªåŠ¨æç¤º">å¯¹ go getå¼•å…¥çš„åŒ…ä¸èƒ½è‡ªåŠ¨æç¤º</h4><p>æœ‰è¯´éœ€è¦æ¸…ç†ç¼“å­˜é‡æ–°å¯åŠ¨ï¼Œæœ‰è¯´éœ€è¦ go mod vendorï¼Œ ä½†éƒ½ä¸èµ·æ•ˆï¼ŒåŠ ä¸Š<code>-u</code> é€‰é¡¹å°±èµ·æ•ˆäº† <code>go get -u -x -v pkg_url</code></p><h2 id="è¯­è¨€">è¯­è¨€</h2><h3 id="channel">channel</h3><h4 id="è¯»å†™æ“ä½œ">è¯»å†™æ“ä½œ</h4><figure><img src="/assets/imgs/2024-07-02-go-channel.png"alt="readã€writeã€close" /><figcaption aria-hidden="true">readã€writeã€close</figcaption></figure>]]></content>
    
    
    <summary type="html">Go è¯­è¨€å­¦ä¹ ç¬”è®°</summary>
    
    
    
    <category term="ç¼–ç¨‹è¯­è¨€" scheme="http://blog.soul11201.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
    <category term="Golang" scheme="http://blog.soul11201.com/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>yii2-queue Redis æºç åˆ†æ</title>
    <link href="http://blog.soul11201.com/2021/12/27/yii2-queue/"/>
    <id>http://blog.soul11201.com/2021/12/27/yii2-queue/</id>
    <published>2021-12-27T06:28:34.000Z</published>
    <updated>2024-07-01T10:29:57.178Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç®€ä»‹">ç®€ä»‹</h2><p>ä¸€ä¸ªæµè¡Œçš„ Yii2 é˜Ÿåˆ—æ‰©å±•ï¼Œæ”¯æŒé©±åŠ¨æ”¯æŒDB,Redis,RabbitMQ,Bestalk,Germanç­‰åå¤šç§æŠ€æœ¯æ¶æ„</p><p>æºç åœ°å€: https://github.com/yiisoft/yii2-queue</p><p>ä¸‹é¢å¯¹ä»¥ Redis ä¸ºé©±åŠ¨çš„å®ç°æºç è¿›è¡Œç®€è¦åˆ†æ</p><h2 id="æ•°æ®ç»“æ„">æ•°æ®ç»“æ„</h2><table><thead><tr><th>åç§°</th><th>redis æ•°æ®ç±»å‹</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>$(channel).moving_lock</td><td>string</td><td>åˆ†å¸ƒå¼é”ï¼Œéƒ¨åˆ†é˜Ÿåˆ—æ“ä½œï¼Œéœ€è¦è¿›è¡ŒåŠ é”å¤„ç†</td></tr><tr><td>$(channel).waiting</td><td>list</td><td>å¾…å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—</td></tr><tr><td>$(channel).reserved</td><td>zset</td><td>é‡è¯•é˜Ÿåˆ—ï¼Œç”¨äºä¸šåŠ¡å¤„ç†å¤±è´¥æƒ…å†µä¸‹ï¼Œè¿›è¡Œä¸‹æ¬¡é‡è¯•</td></tr><tr><td>$(channel).delayed</td><td>zset</td><td>å»¶è¿Ÿé˜Ÿåˆ—ï¼Œå¯¹æ¶ˆæ¯è¿›è¡Œå»¶è¿Ÿå¤„ç†</td></tr><tr><td>$(channel).attempts</td><td>hash</td><td>å­˜å­˜æ¯æ¡æ¶ˆæ¯é‡è¯•å¤„ç†æ¬¡æ•°</td></tr><tr><td>$(channel).messages</td><td>hash</td><td>å®Œæ•´çš„æ¶ˆæ¯</td></tr></tbody></table><h2 id="æµç¨‹">æµç¨‹</h2><p><img src="/assets/imgs/2024-07-01-yii2-queue-redis-3.png"title="ä¸»æµç¨‹" alt="alt text" /> <imgsrc="/assets/imgs/2024-07-01-yii2-queue-redis.png" title="reserve"alt="alt text" /> <imgsrc="/assets/imgs/2024-07-01-yii2-queue-redis-2.png" title="moveExpire"alt="alt text" /></p><h2 id="pr">PR</h2><p><ahref="https://github.com/yiisoft/yii2-queue/pull/516/files">yii2-queue#516</a></p>]]></content>
    
    
    <summary type="html">æºç è§£æ</summary>
    
    
    
    <category term="æŠ€æœ¯å†…å¹•" scheme="http://blog.soul11201.com/categories/%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95/"/>
    
    
    <category term="PHP" scheme="http://blog.soul11201.com/tags/PHP/"/>
    
    <category term="Yii2" scheme="http://blog.soul11201.com/tags/Yii2/"/>
    
  </entry>
  
  <entry>
    <title>Go Sarama Kafka æ•°æ®ä¸¢å¤±åˆ†æ</title>
    <link href="http://blog.soul11201.com/2021/12/23/go-invalid-mem-address/"/>
    <id>http://blog.soul11201.com/2021/12/23/go-invalid-mem-address/</id>
    <published>2021-12-23T08:56:36.000Z</published>
    <updated>2024-07-02T14:46:19.031Z</updated>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯ä¸è¿‡ç¨‹">èƒŒæ™¯ä¸è¿‡ç¨‹</h2><p>ç»´æŠ¤çš„ä¸€ä¸ªçº¿ä¸Šå·¥å•åŒæ­¥é¡¹ç›®ï¼Œä¸šåŠ¡æ–¹åé¦ˆå·¥å•ä¸èƒ½åŒæ­¥ã€‚çº¿ä¸Šæ’æŸ¥è¿‡ç¨‹ç®€å•æ€»ç»“ä¸€ä¸‹ã€‚</p><p>æŸ¥çœ‹å®šæ—¶ä»»åŠ¡ï¼Œæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œæ¯åˆ†é’Ÿä¼šæ£€æµ‹è¿›ç¨‹æ˜¯å¦å­˜æ´»ï¼ŒæŒ‚æ‰çš„ä¼šæ‹‰èµ·æ¥ï¼Œå¹¶ä¸”æ¯å¤©å‡Œæ™¨ä¹Ÿä¼šé‡å¯ä¸€ä¸‹è¿›ç¨‹ã€‚</p><p>æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€ä¹Ÿæ˜¯åœ¨<code>S</code>æ€ï¼Œè¿è¡Œæ—¶é—´ä¹Ÿæ— å¼‚å¸¸</p><p>æ—¥å¿—ä¸­æœ‰ä¸€æ¡å¦‚ä¸‹è®°å½•ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">invalid memory address or nil pointer dereference<br><span class="hljs-keyword">exit</span>....<br></code></pre></td></tr></table></figure><p>å¾ˆå¥‡æ€ªï¼Œæ—¥å¿—è®°å½• exitï¼Œä½†æ˜¯è¿›ç¨‹å´æ²¡æœ‰é€€å‡ºã€‚</p><p>æ’æŸ¥æºç ï¼Œç»“æ„é€»è¾‘ç±»ä¼¼ä¸‹é¢ä»£ç æ ·ä¾‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;github.com/Shopify/sarama&quot;</span><br><span class="hljs-string">&quot;github.com/astaxie/beego/logs&quot;</span><br>cluster <span class="hljs-string">&quot;github.com/bsm/sarama-cluster&quot;</span><br><span class="hljs-string">&quot;os&quot;</span><br><span class="hljs-string">&quot;os/signal&quot;</span><br><span class="hljs-string">&quot;runtime/debug&quot;</span><br><span class="hljs-string">&quot;syscall&quot;</span><br>)<br><br><span class="hljs-keyword">var</span> (<br>cfg <span class="hljs-keyword">struct</span> &#123;<br>Kafka <span class="hljs-keyword">struct</span> &#123;<br>Addrs  []<span class="hljs-type">string</span><br>Group  <span class="hljs-type">string</span><br>Topics []<span class="hljs-type">string</span><br>&#125;<br>&#125;<br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">bussiness_logic</span><span class="hljs-params">(message *sarama.ConsumerMessage)</span></span> &#123;<br><span class="hljs-built_in">println</span>(<span class="hljs-string">&quot;pass&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><br><span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br><br><span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">if</span> err := <span class="hljs-built_in">recover</span>(); err != <span class="hljs-literal">nil</span> &#123;<br>fmt.Println(err)<br>fmt.Println(<span class="hljs-string">&quot;exit....&quot;</span>)<br>&#125;<br>&#125;()<br><br><span class="hljs-keyword">var</span> (<br>kafkaConfig   = cluster.NewConfig()<br>KafkaConsumer *cluster.Consumer<br>err           <span class="hljs-type">error</span><br>)<br><br>kafkaConfig.Consumer.Return.Errors = <span class="hljs-literal">true</span><br>kafkaConfig.Group.Return.Notifications = <span class="hljs-literal">true</span><br><br><span class="hljs-keyword">if</span> KafkaConsumer, err = cluster.NewConsumer(cfg.Kafka.Addrs, cfg.Kafka.Group, cfg.Kafka.Topics, kafkaConfig); err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-built_in">panic</span>(err)<br>&#125;<br><br><span class="hljs-keyword">defer</span> KafkaConsumer.Close()<br><br><span class="hljs-keyword">var</span> (<br>message      *sarama.ConsumerMessage<br>notification *cluster.Notification<br>)<br><br><span class="hljs-keyword">for</span> &#123;<br><span class="hljs-keyword">select</span> &#123;<br><span class="hljs-keyword">case</span> message = &lt;-KafkaConsumer.Messages():<br>bussiness_logic(message)<br><span class="hljs-keyword">case</span> notification = &lt;-KafkaConsumer.Notifications():<br>logs.Info(<span class="hljs-string">&quot;kafka notification:%v&quot;</span>, notification)<br><span class="hljs-keyword">case</span> err = &lt;-KafkaConsumer.Errors():<br>logs.Info(<span class="hljs-string">&quot;kafka error:%v&quot;</span>, err)<br>&#125;<br>&#125;<br>&#125;()<br><br>c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> os.Signal, <span class="hljs-number">1</span>)<br>signal.Notify(c)<br>signal.Ignore(syscall.SIGPIPE, syscall.SIGWINCH, syscall.SIGHUP, syscall.SIGURG)<br><br>s := &lt;-c<br>fmt.Println(s)<br>debug.PrintStack()<br>&#125;<br><br></code></pre></td></tr></table></figure><p>bussiness_logic å‡ºç°æŒ‡é’ˆè®¿é—®å¼‚å¸¸åï¼Œgo åç¨‹ä¼šè¢«å›æ”¶ï¼Œæ‰§è¡Œ<code>defer</code>è¯­å¥ã€‚é—®é¢˜å‡ºåœ¨äº†è¿™é‡Œï¼Œè®°å½•å®Œæ—¥å¿—åï¼Œæ²¡è°ƒç”¨<code>os.Exit(1)</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go">      <span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">if</span> err := <span class="hljs-built_in">recover</span>(); err != <span class="hljs-literal">nil</span> &#123;<br>fmt.Println(err)<br>fmt.Println(<span class="hljs-string">&quot;exit....&quot;</span>)<br>&#125;<br>&#125;()<br></code></pre></td></tr></table></figure><h2 id="æ¶ˆæ¯ä¸ºä»€ä¹ˆä¼šä¸¢å¤±">æ¶ˆæ¯ä¸ºä»€ä¹ˆä¼šä¸¢å¤±ï¼Ÿ</h2><p><img src="/assets/go-sarama.consumer-3.png" /></p><ul><li>åç¨‹ hbloopï¼š é—´éš”ä¸€æ®µæ—¶é—´å‘brokerå‘é€å¿ƒè·³çš„</li><li>åç¨‹ parseResponse,responseFeederï¼šä¼šå°†è·å–åˆ°çš„ kafkaæ‰¹é‡æ¶ˆæ¯å­˜åˆ°å†…å­˜ <code>[]*ConsumerMmessage&#123;&#125;</code> ä¸­,å¹¶é€šè¿‡ç®¡é“<code>chan *ConsumerMmessage</code>å‘é€å‡ºå»ï¼Œåº”ç”¨ç¨‹åºä»è€Œèƒ½ä¸€æ¡ä¸€æ¡çš„æ¶ˆè´¹</li></ul><h3 id="åŸå› ">åŸå› </h3><p>åº”ç”¨ç¨‹åºåœ¨æ¶ˆè´¹å…¶ä¸­ä¸€æ¡æ•°æ®æ—¶ï¼Œä¸šåŠ¡å¤„ç†é€»è¾‘å¤„ç†å‡ºç°å†…å­˜å¼‚å¸¸ï¼Œåç¨‹é€€å‡ºï¼Œç³»ç»Ÿå›æ”¶ã€‚å†…å­˜ä¸­å‰©ä½™æœªæ¶ˆè´¹çš„æ¶ˆæ¯æ—§åœ¨å“ªé‡Œä¸€ç›´ä¸ä¼šè¢«æ¶ˆè´¹ï¼Œç­‰åˆ°è¿›ç¨‹é€šè¿‡ä¿¡å·ç»ˆæ­¢æ—¶ï¼Œè¿™äº›æ¶ˆæ¯è¢«ä¸¢å¼ƒ</p><h2 id="åŒç±»é—®é¢˜-demo">åŒç±»é—®é¢˜ demo</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;sync&quot;</span><br><span class="hljs-string">&quot;time&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><br><span class="hljs-keyword">var</span> f <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span><br><br>c := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)<br>d := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)<br>wg := sync.WaitGroup&#123;&#125;<br>wg.Add(<span class="hljs-number">1</span>)<br>    <br>f = <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">if</span> err := <span class="hljs-built_in">recover</span>(); err != <span class="hljs-literal">nil</span> &#123;<br>fmt.Println(err)<br>fmt.Println(<span class="hljs-string">&quot;exit....&quot;</span>)<br>&#125;<br>&#125;()<br><br><span class="hljs-keyword">for</span> data := <span class="hljs-keyword">range</span> d &#123;<br>fmt.Printf(<span class="hljs-string">&quot;cosume %d\n &quot;</span>, data)<br><br><span class="hljs-keyword">var</span> i *<span class="hljs-type">int</span><br>*i = <span class="hljs-number">1</span><br>fmt.Println(i, &amp;i, *i)<br>&#125;<br><br>&#125;<br><br><span class="hljs-keyword">go</span> f()<br><br><span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">for</span> &#123;<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-\n&quot;</span>)<br><span class="hljs-keyword">select</span> &#123;<br><span class="hljs-keyword">case</span> x, _ := &lt;-c:<br>d &lt;- x<br>&#125;<br>&#125;<br>&#125;()<br><br><span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++ &#123;<br>fmt.Printf(<span class="hljs-string">&quot;producing %d:\n&quot;</span>, i)<br>c &lt;- i<br>&#125;<br>&#125;()<br>    <br>    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br>t := time.Tick(<span class="hljs-number">1</span> * time.Second)<br><br><span class="hljs-keyword">for</span> &#123;<br><span class="hljs-keyword">select</span> &#123;<br><span class="hljs-keyword">case</span> &lt;-t:<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--\n&quot;</span>)<br><br>&#125;<br>&#125;<br>&#125;()<br><br>time.Sleep(<span class="hljs-number">1</span> * time.Second)<br><br>wg.Wait()<br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">çº¿ä¸Šæ•…éšœæ’æŸ¥ç¬”è®°</summary>
    
    
    
    <category term="æŠ€æœ¯å†…å¹•" scheme="http://blog.soul11201.com/categories/%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95/"/>
    
    
    <category term="troubleshooting" scheme="http://blog.soul11201.com/tags/troubleshooting/"/>
    
    <category term="Golang" scheme="http://blog.soul11201.com/tags/Golang/"/>
    
    <category term="Kafka" scheme="http://blog.soul11201.com/tags/Kafka/"/>
    
  </entry>
  
  <entry>
    <title>50å²åç»§ç»­å¹²ç¨‹åºå‘˜</title>
    <link href="http://blog.soul11201.com/2021/11/30/dairy/"/>
    <id>http://blog.soul11201.com/2021/11/30/dairy/</id>
    <published>2021-11-30T12:48:52.000Z</published>
    <updated>2024-07-01T08:22:28.042Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸ªé—®é¢˜å›°æ‰°æˆ‘å¾ˆä¹…ï¼Œä¹Ÿå¾ˆéš¾æƒ³æ˜ç™½ï¼Œæƒ³æ˜ç™½å¤ªéš¾ï¼Œå…ˆå†™ç‚¹æ–‡å­—</p><p>35å²åè¿˜èƒ½å¹²çš„åŠ¨å—ï¼Ÿæ€»ä¸èƒ½ä¸€è¾ˆå­å¹²å¤§å¤´å…µå§ï¼Ÿæ€»å¾—å¾€ä¸Šèµ°ä¸€èµ°å§ï¼Œè½¬ç®¡ç†ã€å¸¦é¡¹ç›®ã€å¹²äº§å“ã€è€ƒå…¬åŠ¡å‘˜...ï¼Ÿ</p><p>æ„Ÿè§‰éƒ½å¾ˆç„¦è™‘ï¼Œéšç€å²æ•°å¢é•¿ä½“åŠ›ä¸æ”¯ï¼Œå®¶åº­è´Ÿæ‹…è¿‡å¤§ç²¾åŠ›ä¸å¤Ÿï¼Œå’Œå¹´è½»å…¨å‘˜å·¥æ¯”ä¼šè¢«å…¬å¸æŠ›å¼ƒï¼Œæå¾—å¥½åƒè¡Œä¸šå‘†çš„å¤ªä¹…ï¼Œå°±ä¼šè¢«â€œä½“åˆ¶åŒ–â€æ— æ³•èå…¥ç¤¾ä¼šå†å°±ä¸šã€‚</p><p>å¹²çš„äº‹æƒ…æ‚ä¸ƒæ‚å…«ï¼Œæ²¡æœ‰ç›®æ ‡æ–¹å‘æ„Ÿï¼ŒæŒ£æ‰åœ¨ç”Ÿæ­»çš„è¾¹ç•Œçº¿ä¸Šã€‚</p><p>ä½†æ˜¯ä»”ç»†æƒ³æƒ³è¿™å°±æ˜¯ç°å®å—ï¼Œè½¬è¡Œå¹²å“ªä¸€è¡Œä¸éƒ½é¢ä¸´è¿™äº›é—®é¢˜ï¼Ÿ</p><p>//--------------------------------------------------------------ç¨‹åºå‘˜è¡Œä¸šä»å¤§çš„æ–¹å‘æ¥è¯´æ˜¯ä¿¡æ¯äº§ä¸šï¼Œè¡Œä¸šå‰æ™¯å¾ˆå®½é˜”ã€‚</p><p>ä¸ºä»€ä¹ˆä¸åè¿‡æ¥æƒ³æƒ³æˆ‘ä»¬åšè¿™äº›äº‹æƒ…çš„ç›®çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç¤¾ä¼šä»·å€¼æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿäº’è”ç½‘éš¾åˆ°çœŸæ˜¯äººç±»å†å²çš„ä¸€æ¡å¼¯è·¯å—ï¼Ÿ</p><p>éƒ½è¯´å¸‚åœºæ˜¯ä¸€ä¸ªæ— å½¢çš„æ‰‹ï¼Œä¼˜åŒ–èµ„äº§é…ç½®æ•ˆç‡ï¼Œä½†æ˜¯ä¸å—ç®¡æŸçš„èµ„æœ¬ä¼šæŠŠäººæ¨å‘æ·±æ¸Šã€‚</p><p>åŒ¹å¤«æ— ç½ªï¼Œæ€€ç’§å…¶ç½ªï¼Œ</p><h3 id="ç»§ç»­å¹²ç¨‹åºå‘˜">ç»§ç»­å¹²ç¨‹åºå‘˜ ï¼Ÿ</h3><h3 id="è½¬è¡Œ">è½¬è¡Œ</h3><h4 id="è½¬-ç®¡ç†">è½¬ ç®¡ç†</h4><h4 id="è½¬-pm">è½¬ PM</h4><p><ahref="https://mp.weixin.qq.com/s/BLuViOaJdceYHzTuuPr1DQ">ã€Šè¯»ä¹¦ã€‹æ–°åˆŠ |ç‹è·¯ï¼šæˆ‘çš„é€»è¾‘å¯è’™è€å¸ˆ</a></p><p><ahref="https://www.douban.com/note/271659319/">æ€æ ·æŠŠä¹¦è¯»å¾—â€œå››é€šå…«è¾¾â€ï¼Ÿï¼ˆæ–‡/ç‹è·¯ï¼‰</a></p><p>** å·¥ç¨‹å­¦æ–¹æ³• æŠ“å¤§æ–¹å°ï¼Œé€æ­¥æ±‚ç²¾ åˆ†è€Œæ²»ä¹‹ ç¼–ç¨‹éšæƒ³å•ä¸€ä¿¡æ¯æºä¸å¯é </p><p>è¿™ä¿©äººåŒå</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ä¸ªé—®é¢˜å›°æ‰°æˆ‘å¾ˆä¹…ï¼Œä¹Ÿå¾ˆéš¾æƒ³æ˜ç™½ï¼Œæƒ³æ˜ç™½å¤ªéš¾ï¼Œå…ˆå†™ç‚¹æ–‡å­—&lt;/p&gt;
&lt;p&gt;35
å²åè¿˜èƒ½å¹²çš„åŠ¨å—ï¼Ÿæ€»ä¸èƒ½ä¸€è¾ˆå­å¹²å¤§å¤´å…µå§ï¼Ÿæ€»å¾—å¾€ä¸Šèµ°ä¸€èµ°å§ï¼Œè½¬ç®¡ç†ã€å¸¦é¡¹ç›®ã€å¹²äº§å“ã€è€ƒå…¬åŠ¡å‘˜...ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ„Ÿè§‰éƒ½å¾ˆç„¦è™‘ï¼Œéšç€å²æ•°å¢é•¿ä½“åŠ›ä¸æ”¯ï¼Œå®¶åº­è´Ÿæ‹…è¿‡å¤§ç²¾åŠ›ä¸å¤Ÿï¼Œå’Œå¹´è½»å…¨å‘˜å·¥æ¯”ä¼šè¢«å…¬å¸</summary>
      
    
    
    
    <category term="éšç¬”" scheme="http://blog.soul11201.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
  </entry>
  
  <entry>
    <title>jekyll ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜</title>
    <link href="http://blog.soul11201.com/2021/11/30/jekyll-qa/"/>
    <id>http://blog.soul11201.com/2021/11/30/jekyll-qa/</id>
    <published>2021-11-30T11:59:05.000Z</published>
    <updated>2024-07-02T14:47:00.946Z</updated>
    
    <content type="html"><![CDATA[<p>ç³»ç»Ÿç”¨çš„ Manjaroç”¨çš„è½¯ä»¶åº“éƒ½æ¯”è¾ƒæ–°ï¼Œè¿‡ä¸€æ®µæ—¶é—´å°±è·‘ä¸åŠ¨äº†ï¼Œè®°å½•ä¸‹é—®é¢˜ã€‚</p><h2 id="liquid-syntax-error-line-52-unexpected-character-in">Liquidsyntax error (line 52): Unexpected character $ in</h2><pre><code class="hljs">https://github.com/jekyll/jekyll/issues/5663</code></pre><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">ppp</span> &#125;&#125;</span><br></code></pre></td></tr></table></figure><h2id="libffi.so.7-cannot-open-shared-object-file-no-such-file-or-directory">libffi.so.7:cannot open shared object file: No such file or directory</h2><p>å¼€å§‹ç”¨è½¯é“¾æ¥çš„æ–¹å¼ï¼Œä»¥å‰ç¢°åˆ°è¿‡ç±»ä¼¼é—®é¢˜ï¼Œèƒ½è¿‡å»ï¼Œä½†è¿™æ¬¡æ²¡ä¸å»ã€‚é‡æ–°å®‰è£…ffi gems ä¼šé‡æ–°ç¼–è¯‘ä¸€éä¾èµ–çš„ffiï¼Œé—®é¢˜è§£å†³ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">âœ  jekyll s<br>&lt;internal:/usr/lib/ruby/3.0.0/rubygems/core_ext/kernel_require.rb&gt;:85:in `require&#x27;: libffi.so.7: cannot open shared object file: No such file or directory - <br>...<br>...<br>...<br><br>âœ  sudo ln /usr/lib/libffi.so -s /usr/lib/libffi.so.7<br><br>âœ  jekyll s<br>&lt;internal:/usr/lib/ruby/3.0.0/rubygems/core_ext/kernel_require.rb&gt;:85:in `require&#x27;: /usr/lib/libffi.so.7: version `LIBFFI_CLOSURE_7.0&#x27; not found (required by /home/<br>...<br>...<br>...<br><br><br>âœ   gem install ffi<br></code></pre></td></tr></table></figure><p>é¡ºå¸¦å­¦ä¹ äº†å‡ ä¸ªå‘½ä»¤æŒºå¥½ <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">âœ pacman -Si libffi<br>âœ man ffi<br></code></pre></td></tr></table></figure></p><p>https://bbs.archlinux.org/viewtopic.php?id=270587</p><p>https://github.com/libffi/libffi/blob/master/include/ffi.h.inhttps://github.com/libffi/libffi/blob/master/src/x86/ffi.c</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ç³»ç»Ÿç”¨çš„ Manjaro
ç”¨çš„è½¯ä»¶åº“éƒ½æ¯”è¾ƒæ–°ï¼Œè¿‡ä¸€æ®µæ—¶é—´å°±è·‘ä¸åŠ¨äº†ï¼Œè®°å½•ä¸‹é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&quot;liquid-syntax-error-line-52-unexpected-character-in&quot;&gt;Liquid
syntax error (line 52): </summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="http://blog.soul11201.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="jekyll" scheme="http://blog.soul11201.com/tags/jekyll/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€äº›ä¼˜ç§€çš„ PHP å‚è€ƒèµ„æ–™</title>
    <link href="http://blog.soul11201.com/2021/11/10/opt/"/>
    <id>http://blog.soul11201.com/2021/11/10/opt/</id>
    <published>2021-11-10T12:30:24.000Z</published>
    <updated>2024-07-01T08:18:42.960Z</updated>
    
    <content type="html"><![CDATA[<p>https://learnku.com/php/t/43336https://github.com/soul11201/php-core-hackhttps://www.kancloud.cn/kancloud/php-internals/42741</p><p>https://www.php.net/manual/zh/function.sys-get-temp-dir.phphttps://github.com/php/php-src/blob/af6c11c5f060870d052a2b765dc634d9e47d0f18/main/php_open_temporary_file.c#L238</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;https://learnku.com/php/t/43336
https://github.com/soul11201/php-core-hack
https://www.kancloud.cn/kancloud/php-internals/42741&lt;/p&gt;
&lt;p&gt;ht</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Python å¤šçº¿ç¨‹å¤„ç†ä»»åŠ¡</title>
    <link href="http://blog.soul11201.com/2021/11/05/python-thread/"/>
    <id>http://blog.soul11201.com/2021/11/05/python-thread/</id>
    <published>2021-11-05T12:13:32.000Z</published>
    <updated>2024-07-01T09:52:18.862Z</updated>
    
    <content type="html"><![CDATA[<p>ç¾é¤æ¯å¤©å‘ä¸€ä¸ªç”¨Excelæ±‡æ€»çš„å°±é¤æ•°æ®ï¼Œæˆ‘ä»¬æŠŠå®ƒå¯¼å…¥åˆ°æ•°æ®åº“åï¼Œè¡Œæ”¿åŠå…¬æœåŠ¡ç”¨å®ƒå’Œå…¬å¸å†…çš„å°±é¤æ•°æ®è¿›è¡Œæ¯”å¯¹æŸ¥é‡ã€‚</p><p>åˆå§‹å®ç°æ˜¯å•çº¿ç¨‹ï¼Œå’Œ<code>import_records</code>å»æ‰å¤šçº¿ç¨‹åçš„éƒ¨åˆ†å·®ä¸å¤šã€‚</p><p><code>è¯»å–Excelæ•°æ®</code> ---&gt;<code>å‘é€åˆ°è¡Œæ”¿æœåŠ¡æ¥å£</code></p><p>å®‰å…¨èµ·è§çº¿ä¸Šæ“ä½œæ”¾åœ¨äº†æ™šä¸Šè¿›è¡Œã€‚è¿è¡Œæ—¶å‘ç°æ¯æ¡æ•°æ®å¯¼å…¥æ¶ˆè€—<code>1s</code>å¤šï¼Œæ™šä¸Šåç‚¹å¼€å§‹è·‘è¿™å‡ åƒæ¡æ•°æ®æƒ³æƒ³éƒ½è®©äººå´©æºƒã€‚</p><p>ç­‰ç€ä¹Ÿæ˜¯å¹²ç­‰ï¼Œä¸‹æ¥¼è½¬ä¸¤åœˆé€é€æ°”ï¼Œå±‹é‡Œé¾Œé¾Šçš„ç©ºæ°”è®©äººæ˜æ˜æ²‰æ²‰ï¼Œå¯’å†·è®©äººæ¸…é†’ä¸å°‘ï¼Œçªç„¶æƒ³åˆ°ä¸ºä»€ä¹ˆä¸ç”¨å¤šçº¿ç¨‹å‘¢ï¼Ÿ</p><p>ç¬¬ä¸€ç‰ˆå¤šçº¿ç¨‹å’Œå¤„ç†ä¸šåŠ¡çš„ç¨‹åºç³…åˆåœ¨äº†ä¸€èµ·ï¼Œè·Ÿå±ä¸€æ ·éš¾è¯»ã€‚åé¢ä¸¤å¤©åˆæŠ½äº†ç‚¹æ—¶é—´é‡æ„äº†å‡ ä¸ªç‰ˆæœ¬ï¼Œåˆ†ç¦»å‡ºæ¥ä¸€ä¸ªçº¿ç¨‹æ± ã€è¿­ä»£å™¨å’Œ<code>import_records</code>ã€‚</p><p>æ¸…æ™°ä¸å°‘ï¼Œä½†æ˜¯è¿­ä»£å™¨è¢«æš´éœ²äº†å‡ºæ¥ï¼Œéœ€è¦<code>import_records</code>è°ƒç”¨ä¸€ä¸‹åˆ¤æ–­å½“å‰ä»»åŠ¡æ˜¯å¦ç»™å½“å‰çº¿ç¨‹å¤„ç†ï¼Œç±»ä¼¼åç¨‹çš„æ€è·¯ã€‚</p><p>æš´éœ²æœ‰å¥½æœ‰åï¼Œä½†å·²åŸºæœ¬æ»¡è¶³æ—¥å¸¸ä½¿ç”¨ï¼Œå¯ä»¥å¾€ä¸€è¾¹å…ˆæ”¾æ”¾äº†ã€‚è¯»è¯»ä¹¦ã€çœ‹çœ‹ç”µå½±ï¼Œä¸äº¦ä¹ä¹ï¼šï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> threading<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">task_pool</span>(<span class="hljs-params">thread_num, task_fn</span>):<br><br>  <span class="hljs-keyword">if</span> thread_num &lt;= <span class="hljs-number">0</span> :<br>      <span class="hljs-keyword">raise</span> ValueError<br><br>  threads = []<br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_thread_checker</span>(<span class="hljs-params">thread_id, step</span>):<br><br>      base = <span class="hljs-number">1</span><br>      i = <span class="hljs-number">0</span><br><br>      <span class="hljs-keyword">def</span> <span class="hljs-title function_">thread_checker</span>():<br>          <span class="hljs-keyword">nonlocal</span> i<br><br>          i += <span class="hljs-number">1</span><br>          <span class="hljs-comment"># print((thread_id,i,step, i &lt; base or (i - base) % step != thread_id))</span><br><br>          <span class="hljs-keyword">if</span> i &lt; base <span class="hljs-keyword">or</span> (i - base) % step != thread_id:<br>              <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>          <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>      <span class="hljs-keyword">return</span> thread_checker<br><br><br>  <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, thread_num):<br>    threads.append(threading.Thread(target=task_fn, args=(x,thread_num, gen_thread_checker(x, thread_num))))<br><br>  <span class="hljs-comment"># å¯åŠ¨æ‰€æœ‰çº¿ç¨‹</span><br>  <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:<br>    t.start()<br>  <span class="hljs-comment"># ä¸»çº¿ç¨‹ä¸­ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹é€€å‡º</span><br>  <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:<br>    t.join()<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> argparse<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> openpyxl <span class="hljs-keyword">import</span> load_workbook<br><span class="hljs-keyword">from</span> requests <span class="hljs-keyword">import</span> RequestException<br><br><span class="hljs-keyword">import</span> myThread<br><br>parser = argparse.ArgumentParser(description=<span class="hljs-string">&#x27;ç¾é¤åˆ°åº—äº¤æ˜“æ•°æ®å¯¼å…¥&#x27;</span>)<br>parser.add_argument(<span class="hljs-string">&#x27;--filename&#x27;</span>, <span class="hljs-string">&#x27;-f&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;ç¾é¤åˆ°åº—äº¤æ˜“æ•°æ® .xlsx æ–‡ä»¶è·¯å¾„&#x27;</span>, required=<span class="hljs-literal">True</span>)<br>parser.add_argument(<span class="hljs-string">&#x27;--thread_num&#x27;</span>, <span class="hljs-string">&#x27;-t&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;çº¿ç¨‹æ•°é‡&#x27;</span>, default= <span class="hljs-number">100</span>, required=<span class="hljs-literal">False</span>)<br>parser.add_argument(<span class="hljs-string">&#x27;--debug&#x27;</span>, <span class="hljs-string">&#x27;-d&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;è°ƒè¯•æ¨¡å¼&#x27;</span>, default= <span class="hljs-number">0</span>, required=<span class="hljs-literal">False</span>)<br>args = parser.parse_args()<br><br>filename = args.filename<br>thread_num = <span class="hljs-built_in">int</span>(args.thread_num)<br>debug = args.debug<br><br><span class="hljs-keyword">if</span> debug:<br>    <span class="hljs-built_in">print</span>((filename,thread_num,debug))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_meican_meal_record</span>(<span class="hljs-params">data</span>):<br>   <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">import_records</span>(<span class="hljs-params">thread_id, thread_number, thread_checker</span>):<br>    wb = load_workbook(filename=filename)<br>    ws = wb.active<br><br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> ws:<br>        <span class="hljs-comment">#------------------------------------------</span><br>        <span class="hljs-keyword">if</span> row[<span class="hljs-number">0</span>].value <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">break</span><br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> thread_checker():<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-comment">#------------------------------------------</span><br><br>        <span class="hljs-keyword">if</span> row[<span class="hljs-number">0</span>].value == <span class="hljs-string">&#x27;æ—¥æœŸ&#x27;</span> <span class="hljs-keyword">or</span> row[<span class="hljs-number">0</span>].value == <span class="hljs-string">&#x27;æ€»è®¡&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> re.findall(<span class="hljs-string">&#x27;^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;$&#x27;</span>, row[<span class="hljs-number">0</span>].value):<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">else</span>:<br><br>            date = <span class="hljs-built_in">str</span>.replace(row[<span class="hljs-number">0</span>].value,<span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br><br>            order_id = row[<span class="hljs-number">3</span>].value<br>            restaurant_name = row[<span class="hljs-number">5</span>].value<br>            meal_plan_name = row[<span class="hljs-number">6</span>].value<br>            meal_staffid = row[<span class="hljs-number">10</span>].value<br>            identify = row[<span class="hljs-number">11</span>].value<br>    <br>            add_meican_meal_record(&#123;<br>                <span class="hljs-string">&#x27;orderId&#x27;</span>:order_id,<br>                <span class="hljs-string">&#x27;date&#x27;</span>: date,<br>                <span class="hljs-string">&#x27;meal_plan_name&#x27;</span>:meal_plan_name,<br>                <span class="hljs-string">&#x27;meal_staffid&#x27;</span>:meal_staffid,<br>                <span class="hljs-string">&#x27;identify&#x27;</span>:identify,<br>                <span class="hljs-string">&#x27;restaurant_name&#x27;</span>:restaurant_name<br>            &#125;)<br><br>myThread.task_pool(thread_num,import_records)<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ç¾é¤æ¯å¤©å‘ä¸€ä¸ªç”¨Excelæ±‡æ€»çš„å°±é¤æ•°æ®ï¼Œæˆ‘ä»¬æŠŠå®ƒå¯¼å…¥åˆ°æ•°æ®åº“åï¼Œè¡Œæ”¿åŠå…¬æœåŠ¡ç”¨å®ƒå’Œå…¬å¸å†…çš„å°±é¤æ•°æ®è¿›è¡Œæ¯”å¯¹æŸ¥é‡ã€‚&lt;/p&gt;
&lt;p&gt;åˆå§‹å®ç°æ˜¯å•çº¿ç¨‹ï¼Œå’Œ&lt;code&gt;import_records&lt;/code&gt;å»æ‰å¤šçº¿ç¨‹åçš„éƒ¨åˆ†å·®ä¸å¤šã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;è¯»å–Excelæ•°</summary>
      
    
    
    
    <category term="ç³»ç»Ÿç¼–ç¨‹" scheme="http://blog.soul11201.com/categories/%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Python" scheme="http://blog.soul11201.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>å¤šè¿›ç¨‹å®æˆ˜ - my cron</title>
    <link href="http://blog.soul11201.com/2021/10/31/my_cron/"/>
    <id>http://blog.soul11201.com/2021/10/31/my_cron/</id>
    <published>2021-10-31T15:31:54.000Z</published>
    <updated>2024-07-01T08:19:08.710Z</updated>
    
    <content type="html"><![CDATA[<ul><li>cron ç¨‹åºæ— æ³•ä½¿ç”¨</li><li>å…¬å¸ dcron å¹³å° ä»»åŠ¡ä¸æ–¹ä¾¿ç®¡ç†ï¼Œé¡µé¢åªèƒ½æ˜¾ç¤ºä¸€ä¸ª porjectå’Œtoken<ul><li>è¦ä¹ˆä¸åœçš„åˆ‡æ¢ project åœ¨æµè§ˆå™¨</li><li>è¦ä¹ˆæ‰€æœ‰çš„ä»»åŠ¡éƒ½å‹ç¼©åˆ°ä¸€ä¸ªprojectä¸­ï¼Œå› ä¸ºä»»åŠ¡è¿˜æ— æ³•åˆ é™¤ï¼Œç›®å‰æœ‰è¿‘200ä¸ªä»»åŠ¡</li></ul></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/stat.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;errno.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/wait.h&gt;</span></span><br><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DEBUG 0</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> YII_APP_BASE_DIR <span class="hljs-string">&quot;/var/www/app/yii&quot;</span></span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">job</span>&#123;</span><br>    <span class="hljs-type">char</span>* yii_cmd;<br><br>    <span class="hljs-type">pid_t</span> pid;<br><span class="hljs-comment">//    char* stdout_file;</span><br><span class="hljs-comment">//    char* stderr_file;</span><br>    <span class="hljs-type">int</span> running;<br>&#125;<span class="hljs-type">job_t</span>;<br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">process_job</span><span class="hljs-params">(<span class="hljs-type">job_t</span>* job)</span> &#123;<br>    <span class="hljs-type">pid_t</span> job_pid = fork();<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s %x\n&quot;</span>, __FUNCTION__, job);<br>    <span class="hljs-keyword">if</span>(job_pid == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;----&gt;task %s process id: %d %d\n&quot;</span>,job-&gt;yii_cmd, getpid(), getppid());<br>        execlp(<span class="hljs-string">&quot;php70&quot;</span>, <span class="hljs-string">&quot;php70&quot;</span>,YII_APP_BASE_DIR, job-&gt;yii_cmd, <span class="hljs-literal">NULL</span>);<br>        perror(<span class="hljs-string">&quot;execlp&quot;</span>);<br>    <br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;------------&gt;task manager process id: %d %d\n&quot;</span>, getpid(), getppid());<br>        job-&gt;running = <span class="hljs-number">1</span>;<br>        job-&gt;pid = job_pid;<br>        <span class="hljs-keyword">return</span> job_pid;<br>    &#125; <br>&#125;<br><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">deamanize</span><span class="hljs-params">()</span>&#123;<br>  <br>    <span class="hljs-type">pid_t</span> pid =  fork();<br><br><span class="hljs-meta">#<span class="hljs-keyword">if</span> 1</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;aaaaa&quot;</span>);<br>    fflush(<span class="hljs-built_in">stdout</span>);<br>    <span class="hljs-type">int</span> fd = open(<span class="hljs-string">&quot;/dev/null&quot;</span>,O_RDWR);<br>    dup2(fd,<span class="hljs-number">0</span>);<br>    dup2(fd, <span class="hljs-number">1</span>);<br>    dup2(fd, <span class="hljs-number">2</span>);<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><br>  <br>    <span class="hljs-keyword">if</span>(pid !=<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br><br>    setsid();<br>    umask(<span class="hljs-number">0</span>);<br>    chdir(<span class="hljs-string">&quot;/&quot;</span>);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d\n&quot;</span>, getpid(), getppid());<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>* argv[])</span>&#123;<br> <br>    deamanize();<br><br>    <span class="hljs-type">job_t</span> jobs[] = &#123;<br>        &#123;<br>            .yii_cmd = <span class="hljs-string">&quot;test/test&quot;</span>,<br>            .running = <span class="hljs-number">0</span>,<br>            .pid = <span class="hljs-number">0</span>,<br>        &#125;,<br>    &#125;;<br><br>    <span class="hljs-type">int</span> jobs_num = <span class="hljs-keyword">sizeof</span>(jobs)/<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">job_t</span>);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;job_nums:%d\n&quot;</span>, jobs_num);<br><br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>)&#123;<br>        sleep(<span class="hljs-number">60</span>);<br>        <span class="hljs-type">job_t</span>* jp = jobs;<br>        <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%x %d\n&quot;</span>, jp, i);<br>        <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; jobs_num; ++i, jp++)<br>        &#123;<br>            <span class="hljs-keyword">if</span>(jp-&gt;running)&#123;<br>                <span class="hljs-type">int</span> ret_pid = waitpid(jp-&gt;pid,<span class="hljs-literal">NULL</span>, WNOHANG);<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;waitpid ret_val:%d\n&quot;</span>, ret_pid);<br>                <span class="hljs-keyword">if</span>(ret_pid == jp-&gt;pid)&#123;<br>                    jp-&gt;running = <span class="hljs-number">0</span>;<br>                &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ret_pid == <span class="hljs-number">0</span>)&#123;<br>                    <br>                &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ret_pid == <span class="hljs-number">-1</span>)&#123;<br>                    <span class="hljs-keyword">if</span>(errno == ECHILD) &#123;<br>                        jp-&gt;running = <span class="hljs-number">0</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span>(!jp-&gt;running)&#123;<br>                process_job(&amp;jobs[i]);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">åˆ†å¸ƒå¼å®šæ—¶ä»»åŠ¡ç®¡ç†</summary>
    
    
    
    <category term="ç³»ç»Ÿç¼–ç¨‹" scheme="http://blog.soul11201.com/categories/%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="C" scheme="http://blog.soul11201.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>redis-cli</title>
    <link href="http://blog.soul11201.com/2021/07/29/copy-tools-in-linux/"/>
    <id>http://blog.soul11201.com/2021/07/29/copy-tools-in-linux/</id>
    <published>2021-07-29T07:53:45.000Z</published>
    <updated>2024-07-01T08:21:56.679Z</updated>
    
    <content type="html"><![CDATA[<p>æŠŠä¸€å°æœºå™¨ä¸Šçš„redis-cli æ‹·è´åˆ°å¦å¤–ä¸€å°æœºå™¨ä¸Šå¹¶ä½¿ç”¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">rsync -avz root@10.23.27.2:/usr/bin/redis-cli .<br><br>./redis-cli<br><br>ldd `<span class="hljs-built_in">which</span> redis-cli`<br><br>rsync -avz root@10.23.27.2:/lib64/libjemalloc.so.1 .<br><br><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=`<span class="hljs-built_in">pwd</span>`<br><br>redis-cli<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">åœ¨ä¸åŒçš„ Linux ä¸»æœºé—´å…±äº«äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶</summary>
    
    
    
    <category term="ç ”å‘æ•ˆèƒ½" scheme="http://blog.soul11201.com/categories/%E7%A0%94%E5%8F%91%E6%95%88%E8%83%BD/"/>
    
    
    <category term="Linux" scheme="http://blog.soul11201.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>é›¶å®½æ–­è¨€ - è·¨è¡Œæ—¥å¿—åŒ¹é…</title>
    <link href="http://blog.soul11201.com/2021/07/07/grap-log-use-regex/"/>
    <id>http://blog.soul11201.com/2021/07/07/grap-log-use-regex/</id>
    <published>2021-07-07T10:52:45.000Z</published>
    <updated>2024-07-01T08:39:27.103Z</updated>
    
    <content type="html"><![CDATA[<p><code>\d\d\d\d-\d\d-\d\d \d\d:\d\d:\d\d (.*\n)*?(?=\d\d\d\d-\d\d-\d\d \d\d:\d\d:\d\d)</code></p><p>é›¶å®½åº¦æ–­è¨€åŒ¹é…çš„æ˜¯ä¸€ä¸ªä½ç½®</p><figure class="highlight irb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs irb"><br><span class="hljs-comment">#irb</span><br><br><span class="hljs-meta prompt_">irb(main):018:0&gt;</span> /(<span class="hljs-string">?=\d</span>)\d+(<span class="hljs-string">?=\d</span>)/ === <span class="hljs-string">&quot; 11 &quot;</span><br>=&gt; true<br><br><span class="hljs-meta prompt_">irb(main):020:0&gt;</span> /(<span class="hljs-string">?=\d</span>)\d(<span class="hljs-string">?=\d</span>)/ === <span class="hljs-string">&quot; 11 &quot;</span><br>=&gt; true<br><br><span class="hljs-meta prompt_">irb(main):021:0&gt;</span> /(<span class="hljs-string">?=\d\d</span>)\d(<span class="hljs-string">?=\d</span>)/ === <span class="hljs-string">&quot; 11 &quot;</span><br>=&gt; true<br><br><br><br><br></code></pre></td></tr></table></figure><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs prolog"><span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-07</span> <span class="hljs-number">17</span>:<span class="hljs-number">16</span>:<span class="hljs-number">13</span> [<span class="hljs-number">10.200</span><span class="hljs-number">.35</span><span class="hljs-number">.20</span>][-][-][info][application] [app id:<span class="hljs-number">10012</span>]<br>    in /data0/www/htdocs/holonet.intra.lianjia.com/common/<span class="hljs-symbol">SignKeyChainArrayProvider</span>.php:<span class="hljs-number">41</span><br>    in /data0/www/htdocs/holonet.intra.lianjia.com/vendor/infrastructure/api-signature/src/<span class="hljs-symbol">Http</span>/<span class="hljs-symbol">Yii2</span>/<span class="hljs-symbol">SignFilter</span>.php:<span class="hljs-number">60</span><br><span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-07</span> <span class="hljs-number">17</span>:<span class="hljs-number">16</span>:<span class="hljs-number">13</span> [<span class="hljs-number">10.200</span><span class="hljs-number">.35</span><span class="hljs-number">.20</span>][-][-][info][yii\db\<span class="hljs-symbol">Connection</span>::open] <span class="hljs-symbol">Opening</span> <span class="hljs-symbol">DB</span> connection: mysql:host=m7832.zeus.mysql.ljnode.com;port=<span class="hljs-number">7832</span>;dbname=holonet<br>    in /data0/www/htdocs/holonet.intra.lianjia.com/module/identity/model/<span class="hljs-symbol">AppServiceQuery</span>.php:<span class="hljs-number">45</span><br>    in /data0/www/htdocs/holonet.intra.lianjia.com/common/<span class="hljs-symbol">SignKeyChainArrayProvider</span>.php:<span class="hljs-number">46</span><br>    in /data0/www/htdocs/holonet.intra.lianjia.com/vendor/infrastructure/api-signature/src/<span class="hljs-symbol">Http</span>/<span class="hljs-symbol">Yii2</span>/<span class="hljs-symbol">SignFilter</span>.php:<span class="hljs-number">60</span><br><span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-07</span> <span class="hljs-number">17</span>:<span class="hljs-number">16</span>:<span class="hljs-number">13</span> [<span class="hljs-number">10.200</span><span class="hljs-number">.35</span><span class="hljs-number">.20</span>][-][-][info][yii\db\<span class="hljs-symbol">Command</span>::execute] <span class="hljs-symbol">SET</span> <span class="hljs-symbol">SESSION</span> wait_timeout = <span class="hljs-number">28800</span><br>    in /data0/www/htdocs/holonet.intra.lianjia.com/config/db.php:<span class="hljs-number">17</span><br>    in /data0/www/htdocs/holonet.intra.lianjia.com/module/identity/model/<span class="hljs-symbol">AppServiceQuery</span>.php:<span class="hljs-number">45</span><br>    in /data0/www/htdocs/holonet.intra.lianjia.com/common/<span class="hljs-symbol">SignKeyChainArrayProvider</span>.php:<span class="hljs-number">46</span><br><span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-07</span> <span class="hljs-number">17</span>:<span class="hljs-number">16</span>:<span class="hljs-number">13</span> [<span class="hljs-number">10.200</span><span class="hljs-number">.35</span><span class="hljs-number">.20</span>][-][-][info][yii\db\<span class="hljs-symbol">Command</span>::query] <span class="hljs-symbol">SELECT</span> <span class="hljs-string">`secret_key`</span> <span class="hljs-symbol">FROM</span> <span class="hljs-string">`app_service`</span> <span class="hljs-symbol">WHERE</span> (<span class="hljs-string">`app_id`</span>=<span class="hljs-string">&#x27;10012&#x27;</span>) <span class="hljs-symbol">AND</span> (<span class="hljs-string">`service_id`</span>=<span class="hljs-number">10010</span>)<br>    in /data0/www/htdocs/holonet.intra.lianjia.com/module/identity/model/<span class="hljs-symbol">AppServiceQuery</span>.php:<span class="hljs-number">45</span><br>    in /data0/www/htdocs/holonet.intra.lianjia.com/common/<span class="hljs-symbol">SignKeyChainArrayProvider</span>.php:<span class="hljs-number">46</span><br>    in /data0/www/htdocs/holonet.intra.lianjia.com/vendor/infrastructure/api-signature/src/<span class="hljs-symbol">Http</span>/<span class="hljs-symbol">Yii2</span>/<span class="hljs-symbol">SignFilter</span>.php:<span class="hljs-number">60</span><br><span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-07</span> <span class="hljs-number">17</span>:<span class="hljs-number">16</span>:<span class="hljs-number">13</span> [<span class="hljs-number">10.200</span><span class="hljs-number">.35</span><span class="hljs-number">.20</span>][-][-][trace][yii\base\<span class="hljs-symbol">InlineAction</span>::runWithParams] <span class="hljs-symbol">Running</span> action: app\module\api\controllers\<span class="hljs-symbol">AppServiceController</span>::actionAccessServiceList()<br><span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-07</span> <span class="hljs-number">17</span>:<span class="hljs-number">16</span>:<span class="hljs-number">13</span> [<span class="hljs-number">10.200</span><span class="hljs-number">.35</span><span class="hljs-number">.20</span>][-][-][info][yii\db\<span class="hljs-symbol">Command</span>::query] <span class="hljs-symbol">SELECT</span> <span class="hljs-string">`as`</span>.<span class="hljs-string">`app_id`</span> <span class="hljs-symbol">AS</span> <span class="hljs-string">`app_id`</span>, <span class="hljs-string">`as`</span>.<span class="hljs-string">`secret_key`</span> <span class="hljs-symbol">FROM</span> <span class="hljs-string">`app_service`</span> <span class="hljs-string">`as`</span> <span class="hljs-symbol">WHERE</span> <span class="hljs-string">`service_id`</span>=<span class="hljs-string">&#x27;10002&#x27;</span><br>    in /data0/www/htdocs/holonet.intra.lianjia.com/module/identity/model/<span class="hljs-symbol">AppServiceQuery</span>.php:<span class="hljs-number">36</span><br>    in /data0/www/htdocs/holonet.intra.lianjia.com/module/api/controllers/<span class="hljs-symbol">AppServiceController</span>.php:<span class="hljs-number">28</span><br><span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-07</span> <span class="hljs-number">17</span>:<span class="hljs-number">16</span>:<span class="hljs-number">13</span> [<span class="hljs-number">10.200</span><span class="hljs-number">.35</span><span class="hljs-number">.20</span>][-][-][info][application] [<span class="hljs-symbol">RESPONSE</span>][<span class="hljs-symbol">GET</span> api/app-service/access-service-list][[<br>    <span class="hljs-string">&#x27;code&#x27;</span> =&gt; <span class="hljs-number">0</span><br>    <span class="hljs-string">&#x27;msg&#x27;</span> =&gt; <span class="hljs-string">&#x27;æœåŠ¡æ­£å¸¸&#x27;</span><br>    <span class="hljs-string">&#x27;extra&#x27;</span> =&gt; [<br>        <span class="hljs-number">1001007</span> =&gt; [<br>            <span class="hljs-string">&#x27;app_id&#x27;</span> =&gt; <span class="hljs-string">&#x27;10007&#x27;</span><br>            <span class="hljs-string">&#x27;secret_key&#x27;</span> =&gt; <span class="hljs-string">&#x27;7a8c8e384ffc7c0194&#x27;</span><br>        ]<br>        <span class="hljs-number">1001008</span> =&gt; [<br>            <span class="hljs-string">&#x27;app_id&#x27;</span> =&gt; <span class="hljs-string">&#x27;10008&#x27;</span><br>            <span class="hljs-string">&#x27;secret_key&#x27;</span> =&gt; <span class="hljs-string">&#x27;c3264160624a9677c8&#x27;</span><br>        ]<br>        <span class="hljs-number">1001009</span> =&gt; [<br>            <span class="hljs-string">&#x27;app_id&#x27;</span> =&gt; <span class="hljs-string">&#x27;10009&#x27;</span><br>            <span class="hljs-string">&#x27;secret_key&#x27;</span> =&gt; <span class="hljs-string">&#x27;81a8bf7589a13f21f1&#x27;</span><br>        ]<br>        <span class="hljs-number">1001017</span> =&gt; [<br>            <span class="hljs-string">&#x27;app_id&#x27;</span> =&gt; <span class="hljs-string">&#x27;10017&#x27;</span><br>            <span class="hljs-string">&#x27;secret_key&#x27;</span> =&gt; <span class="hljs-string">&#x27;35741b5aa744c5518&#x27;</span><br>        ]<br>        <span class="hljs-number">1001023</span> =&gt; [<br>            <span class="hljs-string">&#x27;app_id&#x27;</span> =&gt; <span class="hljs-string">&#x27;10023&#x27;</span><br>            <span class="hljs-string">&#x27;secret_key&#x27;</span> =&gt; <span class="hljs-string">&#x27;5fee8f3d61f0cf5315a1d&#x27;</span><br>        ]<br>        <span class="hljs-number">1001025</span> =&gt; [<br>            <span class="hljs-string">&#x27;app_id&#x27;</span> =&gt; <span class="hljs-string">&#x27;10025&#x27;</span><br>            <span class="hljs-string">&#x27;secret_key&#x27;</span> =&gt; <span class="hljs-string">&#x27;838a843ecfc41084db&#x27;</span><br>        ]<br>        <span class="hljs-number">1001026</span> =&gt; [<br>            <span class="hljs-string">&#x27;app_id&#x27;</span> =&gt; <span class="hljs-string">&#x27;10026&#x27;</span><br>            <span class="hljs-string">&#x27;secret_key&#x27;</span> =&gt; <span class="hljs-string">&#x27;17b834119e6d8&#x27;</span><br>        ]<br>        <span class="hljs-number">1001002</span> =&gt; [<br>            <span class="hljs-string">&#x27;app_id&#x27;</span> =&gt; <span class="hljs-string">&#x27;10002&#x27;</span><br>            <span class="hljs-string">&#x27;secret_key&#x27;</span> =&gt; <span class="hljs-string">&#x27;8215d0a4fc997a8a&#x27;</span><br>        ]<br>        <span class="hljs-number">1001043</span> =&gt; [<br>            <span class="hljs-string">&#x27;app_id&#x27;</span> =&gt; <span class="hljs-string">&#x27;10043&#x27;</span><br>            <span class="hljs-string">&#x27;secret_key&#x27;</span> =&gt; <span class="hljs-string">&#x27;b16f3c14cfe50cce&#x27;</span><br>        ]<br>        <span class="hljs-number">1001048</span> =&gt; [<br>            <span class="hljs-string">&#x27;app_id&#x27;</span> =&gt; <span class="hljs-string">&#x27;1001048&#x27;</span><br>            <span class="hljs-string">&#x27;secret_key&#x27;</span> =&gt; <span class="hljs-string">&#x27;26f035e8112d0cea5&#x27;</span><br>        ]<br>    ]<br>    <span class="hljs-string">&#x27;type&#x27;</span> =&gt; <span class="hljs-string">&#x27;app&#x27;</span><br>    <span class="hljs-string">&#x27;date&#x27;</span> =&gt; <span class="hljs-string">&#x27;2021-07-07 17:16:13&#x27;</span><br>]]<br>    in /data0/www/htdocs/holonet.intra.lianjia.com/common/<span class="hljs-symbol">LogHttpReqRes</span>.php:<span class="hljs-number">49</span><br><span class="hljs-number">2021</span><span class="hljs-number">-07</span><span class="hljs-number">-07</span> <span class="hljs-number">17</span>:<span class="hljs-number">16</span>:<span class="hljs-number">13</span> [<span class="hljs-number">10.200</span><span class="hljs-number">.35</span><span class="hljs-number">.20</span>][-][-][warning][yii\debug\<span class="hljs-symbol">Module</span>::checkAccess] <span class="hljs-symbol">Access</span> to debugger is denied due to <span class="hljs-symbol">IP</span> address restriction. <span class="hljs-symbol">The</span> requesting <span class="hljs-symbol">IP</span> address is <span class="hljs-number">10.200</span><span class="hljs-number">.35</span><span class="hljs-number">.20</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿›è¡Œæ—¥å¿—æ£€ç´¢</summary>
    
    
    
    <category term="æŠ€æœ¯" scheme="http://blog.soul11201.com/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="troubleshooting" scheme="http://blog.soul11201.com/tags/troubleshooting/"/>
    
  </entry>
  
  <entry>
    <title>Yii2 ã€socket ä¸ å¤šè¿›ç¨‹</title>
    <link href="http://blog.soul11201.com/2021/06/20/fork-socket/"/>
    <id>http://blog.soul11201.com/2021/06/20/fork-socket/</id>
    <published>2021-06-20T07:31:40.000Z</published>
    <updated>2024-07-01T08:39:49.265Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ä¸¤å‘¨åš code reviewçš„æ—¶å€™å‘ç°åŒäº‹ç”¨äº†è®¸ä¹…ä¸è§çš„ pcntlæ‰©å±•ï¼Œæ¯ä¸ªè¿›ç¨‹ç”¨æ¥æ¶ˆè´¹ä¸€ä¸ª redis channal æé«˜å¯¹æ¶ˆæ¯å¤„ç†çš„ååé‡ã€‚</p><p>å› ä¸ºPHP è‡ªèº«çš„ä¸€äº›åŸå› ï¼Œè¿™å¥—æ‰©å±•åœ¨ PHPä¸­æ˜¯ä¸æ€ä¹ˆå¸¸ç”¨çš„ã€‚è®°å¾—æ¯”è¾ƒæœ‰åçš„ä¸€ä¸ªé¡¹ç›®æ˜¯ workermanã€‚</p><p>å¤šè¿›ç¨‹è¿™å—æŠ€æœ¯å…¶å®æ˜¯ä¸€ä¸ªæŒºå¯¹è‡ªèº«çŸ¥è¯†é‡å­˜å‚¨çš„çµé­‚æ‹·é—®ï¼Œå¾€æ·±å¤„æŒ–ï¼Œå¯ä»¥æŒ–å‡ºæ¥æ— æ•°çš„ä¸œè¥¿ï¼šäº‹åŠ¡ã€é”ã€ä¿¡å·ã€IPCã€IOæ“ä½œã€socketã€å¤šçº¿ç¨‹ï¼Œè¿™äº›éƒ½ä¸è¿›ç¨‹æœ‰åƒä¸ä¸‡ç¼•çš„å…³ç³»ã€‚</p><h2 id="å‡ è¡Œä»£ç ">å‡ è¡Œä»£ç </h2><p>ä¸‹é¢è¿™æ®µä»£ç ä¸­ redis socket é“¾æ¥ä¼šä¸ä¼šåœ¨å¤šè¿›ç¨‹é—´å…±äº«ï¼ŒredisæŒ‡ä»¤å–å‡ºçš„æ•°æ®ç»“æœä¼šä¸ä¼šé”™ä¹±åˆ†é…åˆ°éå¯¹åº”çš„è¿›ç¨‹ï¼Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>......<br><span class="hljs-variable">$redis</span> = <span class="hljs-title class_">\Yii</span>::<span class="hljs-variable">$app</span>-&gt;redis;<br><br>        <span class="hljs-variable">$pid</span> = <span class="hljs-title function_ invoke__">pcntl_fork</span>();<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pid</span> == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-variable">$key</span> = <span class="hljs-string">&#x27;redis-key&#x27;</span>;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>                <span class="hljs-variable">$data</span> = <span class="hljs-variable">$redis</span>-&gt;<span class="hljs-title function_ invoke__">lpop</span>(<span class="hljs-variable">$key</span>);<br><br>......<br></code></pre></td></tr></table></figure><h2 id="man-2-linux-programmers-manual"><code>man  2</code> LinuxProgrammer's Manual</h2><h3 id="man-2-fork">man 2 fork</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">*  The child inherits copies of the parent&#x27;s set of open file descriptors.  Each file descriptor in the child refers to the same  open<br>   file  description (see open(2)) as the corresponding file descriptor in the parent.  This means that the two file descriptors share<br>   open file status flags, file offset, and signal-driven I/O attributes (see the description of F_SETOWN and F_SETSIG in fcntl(2)).<br></code></pre></td></tr></table></figure><p>çˆ¶å­è¿›ç¨‹é—´ä¼š COPY æ–‡ä»¶æè¿°ç¬¦ï¼Œ</p><h3 id="man-2-soccket">man 2 soccket</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">socket()  creates  an  endpoint for communication and returns a file descriptor that refers to that endpoint.  The file descriptor reâ€turned by a successful call will be the lowest-numbered file descriptor not currently open for the process.<br></code></pre></td></tr></table></figure><p>socket å¥—æ¥å­—æ˜¯æ–‡ä»¶æè¿°ç¬¦ã€‚</p><p>åˆå»ç¿»é˜…äº†ä¸€ä¸‹ unixç½‘ç»œç¼–ç¨‹ apueèµ„æ–™æŸ¥é˜…äº†ä¸€ä¸‹ã€‚unpv1 å¯¹å¤šè¿›ç¨‹ socketé€šä¿¡æ¨¡å‹è®²çš„å¾ˆæ˜¯æµ…æ˜¾æ˜“æ‡‚ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>åŸºæœ¬å¯ä»¥ç¡®å®šsocket å¥—æ¥å­—å¦‚æœåœ¨forkä¹‹å‰åˆ›å»ºã€‚TCPé“¾æ¥é“¾æ¥å°±ä¼šè¢«å¤šä¸ªè¿›ç¨‹å¤ç”¨ã€‚å¯¹ç«¯æ— æ³•åŒºåˆ†æ˜¯é‚£ä¸ªçˆ¶å­è¿›ç¨‹è°å‘è¿‡æ¥çš„æ•°æ®ã€‚</p><p>ä½†æ˜¯è¿˜æ˜¯éœ€è¦å†™ä»£ç éªŒè¯ä¸€ä¸‹ï¼Œç†è®ºæ€»æ˜¯è¦æ˜¯ç»è¿‡å®è·µçš„æ£€éªŒæ‰ä¼šè¸å®ã€‚</p><h2 id="å®éªŒ">å®éªŒ</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs c"><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;errno.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arpa/inet.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXLINE  4096</span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argv, <span class="hljs-type">char</span> * argc[])</span><br>&#123;<br>    <span class="hljs-type">char</span>recvline[MAXLINE + <span class="hljs-number">1</span>];<br><br>    <span class="hljs-type">int</span> s = socket(AF_INET, SOCK_STREAM, <span class="hljs-number">0</span>);<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">server_addr</span>;</span><br><br>    bzero(&amp;server_addr, <span class="hljs-keyword">sizeof</span>(server_addr));<br><br>    server_addr.sin_port = htons(<span class="hljs-number">8888</span>);<br>    server_addr.sin_family = AF_INET;<br>    inet_pton(AF_INET,<span class="hljs-string">&quot;127.0.0.1&quot;</span>, &amp;server_addr.sin_addr);<br><br>    <span class="hljs-keyword">if</span>(connect(s, (<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> sockaddr *) &amp;server_addr, <span class="hljs-keyword">sizeof</span>(server_addr)) &lt; <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;connect error&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-type">int</span> pid = fork();<br><br>    <span class="hljs-keyword">if</span>(pid == <span class="hljs-number">-1</span>) &#123;<br><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, getpid());<br>        <span class="hljs-type">char</span>* msg = <span class="hljs-string">&quot;error&quot;</span>;<br>        write(s,msg, <span class="hljs-built_in">strlen</span>(msg));<br><br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(pid == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;this is parent proecess, pid: %d ppid: %d\n&quot;</span>, getpid(), getppid());<br>        <span class="hljs-type">char</span>* msg = <span class="hljs-string">&quot;this is parent proecess,\n\n&quot;</span>;<br>        write(s,msg, <span class="hljs-built_in">strlen</span>(msg));<br>        <span class="hljs-type">int</span> n = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> ( (n = read(s, recvline, MAXLINE)) &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n Parent receive bytes:%d\n&quot;</span>,n);<br><br>            recvline[n] = <span class="hljs-number">0</span>;<span class="hljs-comment">/* null terminate */</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fputs</span>(recvline, <span class="hljs-built_in">stdout</span>) == EOF) &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, strerror(errno));<br>            &#125;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-type">char</span>* msg = <span class="hljs-string">&quot;this is child proecess,\n\n&quot;</span>;<br>        write(s,msg, <span class="hljs-built_in">strlen</span>(msg));<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;this is child proecess, pid: %d ppid: %d\n&quot;</span>, getpid(), getppid());<br><br><br>        <span class="hljs-type">int</span> n = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> ( (n = read(s, recvline, MAXLINE)) &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n Child receive bytes:%d\n&quot;</span>,n);<br>            recvline[n] = <span class="hljs-number">0</span>;<span class="hljs-comment">/* null terminate */</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fputs</span>(recvline, <span class="hljs-built_in">stdout</span>) == EOF) &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, strerror(errno));<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">gcc fork_t.c &amp;&amp; ./a.out</span><br>this is child proecess, pid: 9898 ppid: 5322<br>this is parent proecess, pid: 9899 ppid: 9898<br><br> Parent receive bytes:7<br>aaaaaa<br><br> Child receive bytes:7<br>aaaaaa<br><br> Child receive bytes:7<br>aaaaaa<br><br> Child receive bytes:8<br>aaaaaaa<br><br> Child receive bytes:7<br>aaaaaa<br><br> Child receive bytes:7<br>aaaaaa<br><br> Child receive bytes:7<br>aaaaaa<br><br> Child receive bytes:7<br>aaaaaa<br><br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">nc -ltx -p8888</span> <br>this is child proecess,<br><br>Received 25 bytes from the socket<br>00000000  74 68 69 73  20 69 73 20  63 68 69 6C  64 20 70 72  this is child pr<br>00000010  6F 65 63 65  73 73 2C 0A  0A                        oecess,..       <br>this is parent proecess,<br><br>Received 26 bytes from the socket<br>00000000  74 68 69 73  20 69 73 20  70 61 72 65  6E 74 20 70  this is parent p<br>00000010  72 6F 65 63  65 73 73 2C  0A 0A                     roecess,..      <br>aaaaaa<br>Sent 7 bytes to the socket<br>00000000  61 61 61 61  61 61 0A                               aaaaaa.         <br>aaaaaa<br>Sent 7 bytes to the socket<br>00000000  61 61 61 61  61 61 0A                               aaaaaa.         <br>aaaaaa<br>Sent 7 bytes to the socket<br>00000000  61 61 61 61  61 61 0A                               aaaaaa.         <br>aaaaaaa<br>Sent 8 bytes to the socket<br>00000000  61 61 61 61  61 61 61 0A                            aaaaaaa.        <br>aaaaaa<br>Sent 7 bytes to the socket<br>00000000  61 61 61 61  61 61 0A                               aaaaaa.         <br>aaaaaa<br>Sent 7 bytes to the socket<br>00000000  61 61 61 61  61 61 0A                               aaaaaa.         <br>aaaaaa<br>Sent 7 bytes to the socket<br>00000000  61 61 61 61  61 61 0A                               aaaaaa.         <br>aaaaaa<br>Sent 7 bytes to the socket<br>00000000  61 61 61 61  61 61 0A                               aaaaaa.         <br><br></code></pre></td></tr></table></figure><h2 id="å…³é”®å°±çœ‹è¿™äº†-redis-yiiapp-redis">å…³é”®å°±çœ‹è¿™äº†<code>$redis = \Yii::$app-&gt;redis;</code></h2><p>Yii2 ä¸­çš„ç»„ä»¶ä¾é  <code>yii\di\ServiceLocator</code>è¿›è¡Œç®¡ç†ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ§åˆ¶åè½¬ä¾èµ–æ³¨å…¥çš„å®ç°ã€‚ä¸‹é¢æ˜¯éƒ¨åˆ†ä»£ç ç‰‡æ®µï¼šè·å–å¯¹è±¡å®ä¾‹ä¸æ³¨å…¥å¯¹è±¡å®šä¹‰ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><br> <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Returns the component instance with the specified ID.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> string $id component ID (e.g. `db`).</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> bool $throwException whether to throw an exception if `$id` is not registered with the locator before.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> object|null the component of the specified ID. If `$throwException` is false and `$id`</span><br><span class="hljs-comment">     * is not registered before, null will be returned.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> InvalidConfigException if `$id` refers to a nonexistent component ID</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@see</span> has()</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@see</span> set()</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$id</span>, <span class="hljs-variable">$throwException</span> = <span class="hljs-literal">true</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;_components[<span class="hljs-variable">$id</span>])) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;_components[<span class="hljs-variable">$id</span>];<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;_definitions[<span class="hljs-variable">$id</span>])) &#123;<br>            <span class="hljs-variable">$definition</span> = <span class="hljs-variable language_">$this</span>-&gt;_definitions[<span class="hljs-variable">$id</span>];<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$definition</span>) &amp;&amp; !<span class="hljs-variable">$definition</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Closure</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;_components[<span class="hljs-variable">$id</span>] = <span class="hljs-variable">$definition</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;_components[<span class="hljs-variable">$id</span>] = <span class="hljs-title class_">Yii</span>::<span class="hljs-title function_ invoke__">createObject</span>(<span class="hljs-variable">$definition</span>);<br>        &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$throwException</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidConfigException</span>(<span class="hljs-string">&quot;Unknown component ID: <span class="hljs-subst">$id</span>&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Registers a component definition with this locator.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * For example,</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * ```php</span><br><span class="hljs-comment">     * // a class name</span><br><span class="hljs-comment">     * $locator-&gt;set(&#x27;cache&#x27;, &#x27;yii\caching\FileCache&#x27;);</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * // a configuration array</span><br><span class="hljs-comment">     * $locator-&gt;set(&#x27;db&#x27;, [</span><br><span class="hljs-comment">     *     &#x27;class&#x27; =&gt; &#x27;yii\db\Connection&#x27;,</span><br><span class="hljs-comment">     *     &#x27;dsn&#x27; =&gt; &#x27;mysql:host=127.0.0.1;dbname=demo&#x27;,</span><br><span class="hljs-comment">     *     &#x27;username&#x27; =&gt; &#x27;root&#x27;,</span><br><span class="hljs-comment">     *     &#x27;password&#x27; =&gt; &#x27;&#x27;,</span><br><span class="hljs-comment">     *     &#x27;charset&#x27; =&gt; &#x27;utf8&#x27;,</span><br><span class="hljs-comment">     * ]);</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * // an anonymous function</span><br><span class="hljs-comment">     * $locator-&gt;set(&#x27;cache&#x27;, function ($params) &#123;</span><br><span class="hljs-comment">     *     return new \yii\caching\FileCache;</span><br><span class="hljs-comment">     * &#125;);</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * // an instance</span><br><span class="hljs-comment">     * $locator-&gt;set(&#x27;cache&#x27;, new \yii\caching\FileCache);</span><br><span class="hljs-comment">     * ```</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * If a component definition with the same ID already exists, it will be overwritten.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> string $id component ID (e.g. `db`).</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> mixed $definition the component definition to be registered with this locator.</span><br><span class="hljs-comment">     * It can be one of the following:</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * - a class name</span><br><span class="hljs-comment">     * - a configuration array: the array contains name-value pairs that will be used to</span><br><span class="hljs-comment">     *   initialize the property values of the newly created object when [[get()]] is called.</span><br><span class="hljs-comment">     *   The `class` element is required and stands for the the class of the object to be created.</span><br><span class="hljs-comment">     * - a PHP callable: either an anonymous function or an array representing a class method (e.g. `[&#x27;Foo&#x27;, &#x27;bar&#x27;]`).</span><br><span class="hljs-comment">     *   The callable will be called by [[get()]] to return an object associated with the specified component ID.</span><br><span class="hljs-comment">     * - an object: When [[get()]] is called, this object will be returned.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> InvalidConfigException if the definition is an invalid configuration array</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">set</span>(<span class="hljs-params"><span class="hljs-variable">$id</span>, <span class="hljs-variable">$definition</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;_components[<span class="hljs-variable">$id</span>]);<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$definition</span> === <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;_definitions[<span class="hljs-variable">$id</span>]);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$definition</span>) || <span class="hljs-title function_ invoke__">is_callable</span>(<span class="hljs-variable">$definition</span>, <span class="hljs-literal">true</span>)) &#123;<br>            <span class="hljs-comment">// an object, a class name, or a PHP callable</span><br>            <span class="hljs-variable language_">$this</span>-&gt;_definitions[<span class="hljs-variable">$id</span>] = <span class="hljs-variable">$definition</span>;<br>        &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$definition</span>)) &#123;<br>            <span class="hljs-comment">// a configuration array</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$definition</span>[<span class="hljs-string">&#x27;__class&#x27;</span>])) &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;_definitions[<span class="hljs-variable">$id</span>] = <span class="hljs-variable">$definition</span>;<br>                <span class="hljs-variable language_">$this</span>-&gt;_definitions[<span class="hljs-variable">$id</span>][<span class="hljs-string">&#x27;class&#x27;</span>] = <span class="hljs-variable">$definition</span>[<span class="hljs-string">&#x27;__class&#x27;</span>];<br>                <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;_definitions[<span class="hljs-variable">$id</span>][<span class="hljs-string">&#x27;__class&#x27;</span>]);<br>            &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$definition</span>[<span class="hljs-string">&#x27;class&#x27;</span>])) &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;_definitions[<span class="hljs-variable">$id</span>] = <span class="hljs-variable">$definition</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidConfigException</span>(<span class="hljs-string">&quot;The configuration for the \&quot;<span class="hljs-subst">$id</span>\&quot; component must contain a \&quot;class\&quot; element.&quot;</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidConfigException</span>(<span class="hljs-string">&quot;Unexpected configuration type for the \&quot;<span class="hljs-subst">$id</span>\&quot; component: &quot;</span> . <span class="hljs-title function_ invoke__">gettype</span>(<span class="hljs-variable">$definition</span>));<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>ç»“åˆ <code>yii\redis\Connection</code> ä¸­çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œ<code>$redis = \Yii::$app-&gt;redis;</code> åªç”Ÿæˆäº†ä¸€ä¸ª<code>yii\redis\Connection</code>å¯¹è±¡ï¼Œä½†æ˜¯å¯¹socketåˆ›å»ºå´æ˜¯æƒ°æ€§è®¡ç®—çš„ï¼Œæ²¡æœ‰ç«‹å³åˆ›å»ºsocketã€‚</p><h2 id="ç»“è®º">ç»“è®º</h2><p>å¼€å¤´çš„é—®é¢˜ä¹Ÿå°±æœ‰äº†ç­”æ¡ˆï¼Œä¸ä¼šã€‚</p>]]></content>
    
    
    <summary type="html">Yii2 ã€socket ä¸ å¤šè¿›ç¨‹</summary>
    
    
    
    <category term="ç³»ç»Ÿç¼–ç¨‹" scheme="http://blog.soul11201.com/categories/%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="PHP" scheme="http://blog.soul11201.com/tags/PHP/"/>
    
    <category term="Yii2" scheme="http://blog.soul11201.com/tags/Yii2/"/>
    
  </entry>
  
</feed>
